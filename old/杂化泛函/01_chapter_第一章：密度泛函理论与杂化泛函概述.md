# 第一章：密度泛函理论与杂化泛函概述

# 第一章：密度泛函理论与杂化泛函概述

本章将为读者提供必要的理论背景，帮助理解为什么需要使用杂化泛函以及它们如何改进了传统DFT方法的局限性。我们将从密度泛函理论的基础概念开始，逐步深入到杂化泛函的概念及其优势，并简要介绍LCAO方法在执行杂化泛函计算时的特点。

## Section 1.1: 密度泛函理论简介

### 基础概念
密度泛函理论（Density Functional Theory, DFT）是目前最广泛使用的量子力学方法之一，用于研究物质的电子结构。DFT的核心思想是通过电子密度而非波函数来描述多电子系统，从而大大简化了问题的复杂度。DFT的理论基础主要包括Hohenberg-Kohn定理和Kohn-Sham方程。

- **Hohenberg-Kohn定理**：该定理表明，对于一个给定的外部势场，系统的基态能量仅依赖于电子密度，而与其他变量无关。这意味着，我们可以通过优化电子密度来找到系统的基态能量。
- **Kohn-Sham方程**：为了求解电子密度，引入了一组无相互作用的单电子轨道（Kohn-Sham轨道），这些轨道满足薛定谔方程形式的方程。通过求解这些方程，我们可以得到电子密度，进而计算出系统的总能量。

### 关键参数
虽然本节不涉及具体的`INPUT`文件参数，但理解这些基本概念对于后续章节中选择合适的`dft_functional`等参数至关重要。

## Section 1.2: 杂化泛函的概念与优势

### 杂化泛函的概念
杂化泛函（Hybrid Functionals）是在传统的交换关联泛函中引入一部分Hartree-Fock（HF）交换能，以改善对电子交换相互作用的描述。这种混合方式可以显著提高带隙预测、表面性质和吸附行为等方面的计算精度。

- **Hartree-Fock交换能**：HF交换能是一种精确的交换能形式，它考虑了电子之间的库仑排斥力。然而，纯HF方法忽略了相关能，导致其在某些情况下表现不佳。
- **杂化比例**：通过调整HF交换能的比例（通常用`exx_hybrid_alpha`参数表示），可以在保持HF优点的同时，引入局域或半局域泛函的相关能部分，从而达到更好的平衡。

### 关键参数
- **`dft_functional`**：指定所使用的杂化泛函类型，如`pbe0`, `hse`, `scan0`等。
- **`exx_hybrid_alpha`**：定义HF交换能的比例，默认值取决于具体泛函，例如PBE0为0.25。
- **`exx_hse_omega`**：HSE泛函中的范围分离参数，默认值为0.11。

### 编译注意事项
- **LibXC支持**：确保ABACUS编译时链接了LibXC库，这对于支持高级功能如HSE泛函至关重要。
- **实验性功能**：平面波下的杂化泛函是实验性功能，尚未经过全面测试，请参考官方文档获取最新信息。

## Section 1.3: LCAO方法简述

### LCAO方法
线性组合原子轨道（Linear Combination of Atomic Orbitals, LCAO）方法是一种常用的电子结构计算方法。它通过将原子轨道线性组合来构造分子轨道，从而简化了计算过程。相比于平面波方法，LCAO方法在处理大体系和复杂材料时具有更高的效率。

### 关键参数
- **`basis_type`**：设置为`lcao`，表示使用数值原子轨道基组。

### 计算策略
- **内存管理**：对于大规模计算任务，建议评估并适当调整内存分配策略，以避免因资源不足导致的任务失败。

### 示例代码
以下是一个简单的`INPUT`文件示例，展示了如何设置杂化泛函和LCAO方法：

```plaintext
&GLOBAL
  run_type = "scf"
  out_level = 1
  basis_type = "lcao"
/
&ELECTRON
  dft_functional = "pbe0"
  exx_hybrid_alpha = 0.25
  ks_solver = "genelpa"
  nband = 30
  smearing_method = "gaussian"
  smearing_sigma = 0.01
/
&FORCE_EVAL
  stress = .TRUE.
  do_force = .TRUE.
/
```

### 总结
本章介绍了密度泛函理论的基础概念，解释了杂化泛函的优势及其关键参数，并简要讨论了LCAO方法的特点。通过这些内容，读者将能够更好地理解和应用ABACUS软件中的相关功能，进行更准确的材料模拟和计算。