## 第三章：能带结构与态密度

**本章逻辑**: 电子基态确定后，我们可以通过计算能带结构和态密度来进一步理解材料的电子性质。本章将详细介绍这些计算方法及其物理意义。

### Section 3.1: 能带结构基础

#### 理论铺垫

能带结构是固体物理学中的一个核心概念，它描述了固体中电子的能量分布。在晶体中，由于周期性势场的作用，电子的能量不再是连续的，而是形成了一系列的能带。每个能带由一系列允许的能量状态组成，而能带之间则存在禁带（或带隙），其中没有允许的能量状态。

- **直接带隙与间接带隙**：
  - **直接带隙**：价带顶和导带底位于同一个波矢点上。这种材料通常具有较高的光吸收系数，适用于光电应用。
  - **间接带隙**：价带顶和导带底位于不同的波矢点上。这种材料通常具有较低的光吸收系数，但热稳定性较好。

> Note: 在DFT计算中，常用的泛函如PBE（Perdew-Burke-Ernzerhof）往往低估了实际的带隙值。这是因为PBE泛函在处理强关联电子系统时表现不佳。对于某些材料，特别是过渡金属氧化物，使用DFT+U方法可以更准确地描述其带隙。

### Section 3.2: 态密度（DOS）计算

#### 理论铺垫

态密度（Density of States, DOS）是描述固体中能量状态数量的函数。DOS 描述了在给定能量范围内单位能量间隔内的状态数。DOS 是研究材料电子性质的重要工具，特别是在分析材料的电学、光学和磁学性质时。

- **DOS 的定义**：
  \[
  g(E) = \sum_{n, \mathbf{k}} \delta(E - E_{n\mathbf{k}})
  \]
  其中 \(E_{n\mathbf{k}}\) 是第 \(n\) 个能带在波矢 \(\mathbf{k}\) 处的能量。

- **DOS 的计算方法**：
  - **Tetrahedron 方法**：通过在布里渊区中划分四面体网格来计算DOS。
  - **Gaussian 平滑方法**：通过对能量进行高斯平滑来计算DOS。

### Section 3.3: 实战演练 - 用DFT+U改进带隙

#### 案例背景

我们将以二氧化钛（TiO₂）的金红石相为例，展示如何通过DFT+U方法改进带隙计算。TiO₂是一种重要的半导体材料，广泛应用于光催化、太阳能电池等领域。

#### 关键操作

1. **几何优化（弛豫）**：
   - 首先，我们需要对TiO₂的晶胞进行几何优化，以确保晶格参数和原子位置达到最低能量状态。

2. **能带结构计算**：
   - 在几何优化完成后，我们将进行非自洽场（Non-SCF）计算，以获得能带结构和态密度。

#### 输入文件配置

以下是本案例的标准ABACUS输入文件配置：

```yaml
# STRU 文件
STRU:
  # 晶体结构信息
  ...

# INPUT 文件
INPUT:
  relax_cell: 1
  force_thr_ev: 0.01
  stress_thr_kbar: 0.5
  max_steps: 60
  calculation: "cell-relax"
  ecutwfc: 100
  scf_thr: 1e-07
  scf_nmax: 100
  smearing_sigma: 0.015
  mixing_beta: 0.8
  ks_solver: "genelpa"
  precision: "double"
  cal_force: 1
  cal_stress: 1
  relax_method: "cg"
  relax_nmax: 60
  stress_thr: 0.5
  fixed_axes: "None"
  dft_plus_u: 1
  orbital_corr: [2, -1]
  hubbard_u: [4.0, 0.0]
  onsite_radius: 3
  uramping: 4.0
  mixing_restart: 0.001
  mode: "pyatb"
  high_symm_points:
    G: [0, 0, 0]
    Y: [0, 0.5, 0]
    M: [0.5, 0.5, 0]
    A: [0, 0, 0.5]
  energy_min: -10
  energy_max: 10
  insert_point_nums: 30

# KPT 文件
KPT:
  kspacing: 0.14
  kpath: ["G", "Y", "M", "A", "G"]
```

> Tip: 在 `INPUT` 文件中，我们设置了 `dft_plus_u: 1`，并为Ti的3d轨道指定了Hubbard U值为4.0 eV。这是为了更好地描述强关联电子系统的电子结构。

#### 计算步骤

1. **几何优化（弛豫）**：
   - 通过设置 `calculation: "cell-relax"` 和相关参数，我们首先对TiO₂的晶胞进行几何优化。优化过程包括力和应力的收敛标准，并使用共轭梯度法（CG）进行优化。

2. **能带结构计算**：
   - 几何优化完成后，我们使用非自洽场（Non-SCF）方法计算能带结构。通过 `high_symm_points` 和 `kpath` 设置，我们定义了沿 \(\Gamma-Y-M-A-\Gamma\) 路径的K点采样。

> Note: 选择 \(\Gamma-Y-M-A-\Gamma\) 路径是因为它遍历了金红石相TiO₂的布里渊区的主要极值点，有助于全面了解其能带结构特征。

#### 结果分析

1. **带隙**：
   - 通过DFT+U方法计算得到的TiO₂金红石相的带隙为2.225 eV。这一结果比标准DFT-PBE方法（通常给出约1.8-2.0 eV）更接近实验值（~3.0-3.2 eV）。

2. **能带结构特征**：
   - 价带主要由O 2p轨道贡献，而导带主要由Ti 3d轨道（t₂g和e₉状态）贡献。DFT+U方法使得Ti 3d轨道的能量更高，从而增加了带隙。

3. **半导体性质**：
   - TiO₂是一种宽禁带半导体，适用于光催化、光伏器件、气体传感器和自清洁涂层等领域。

#### 进一步分析建议

1. **光学性质**：
   - 计算介电函数和吸收谱，以了解TiO₂的光学性质。

2. **缺陷分析**：
   - 研究氧空位和钛间隙等常见缺陷，这些缺陷会影响TiO₂的电导率和光催化性能。

3. **表面性质**：
   - TiO₂的光催化活性与其表面特性密切相关，因此进行表面计算非常有价值。

4. **杂化泛函**：
   - 使用HSE06等杂化泛函可以进一步提高带隙计算的准确性。

通过本章的学习，读者可以掌握如何使用ABACUS软件进行能带结构和态密度的计算，并理解这些计算在材料科学中的重要应用。