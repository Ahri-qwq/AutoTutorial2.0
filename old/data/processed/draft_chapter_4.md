## 第四章：磁性材料与自旋极化

**本章逻辑**: 在掌握了基本的电子结构计算后，我们将进一步探讨磁性材料的性质。本章将介绍自旋极化计算及其在铁磁性材料中的应用。

### Section 4.1: 自旋极化计算基础

#### 理论铺垫
- **自旋极化的概念**
  - 在量子力学中，电子不仅具有轨道角动量，还具有自旋角动量。自旋是一种内禀属性，可以取两个值：+1/2（上自旋）和-1/2（下自旋）。在磁性材料中，由于电子之间的交换相互作用，不同自旋态的电子能量会有所不同，从而导致自旋极化。
  
- **铁磁性与反铁磁性的区别**
  - **铁磁性**：相邻原子的磁矩平行排列，整体表现出宏观磁性。典型的铁磁性材料包括铁、镍和钴。
  - **反铁磁性**：相邻原子的磁矩反平行排列，宏观上不表现出磁性。典型的反铁磁性材料包括MnO和FeO。

### Section 4.2: 铁磁性材料的计算

#### 理论铺垫
- **铁磁性材料的电子结构特点**
  - 铁磁性材料的电子结构通常表现出明显的自旋分裂，即自旋向上的能带和自旋向下的能带之间存在能量差。这种分裂是由于电子之间的交换相互作用引起的。
  - 铁磁性材料的费米面附近通常有较多的自旋向上状态，而较少的自旋向下状态，这导致了净磁矩的形成。

- **自旋极化计算的方法**
  - 在DFT框架下，自旋极化计算需要设置`nspin=2`，并为每个原子指定初始磁矩。通过SCF迭代过程，系统会自动调整磁矩以达到自洽状态。
  - 为了更准确地描述强关联电子系统，可以使用DFT+U方法来修正交换关联泛函。

### Section 4.3: 实战演练 - 铁磁性材料的自旋极化计算

#### 案例选择
- **案例ID**: `problem_4`
- **选择理由**: 铁磁性材料的自旋极化计算是理解磁性材料的关键步骤，通过该案例可以详细展示计算过程。

#### 关键操作
- **设置自旋极化参数**
- **执行计算**
- **分析磁矩分布**

#### 计算流程
1. **几何优化 (弛豫)**
   - 通过几何优化，使晶体结构达到能量最低的状态。
2. **能带结构计算 (非自洽计算)**
   - 在几何优化后的结构上进行能带结构计算，以分析材料的电子性质。
3. **建立初始结构 (建模)**
   - 根据实验数据或理论预测，建立初始的晶体结构模型。

#### 输入文件配置
以下是本章实战案例的标准 ABACUS 输入文件配置：

```markdown
- `STRU`: 晶体结构文件
- `INPUT`: 物理控制参数 (仅展示非默认的关键参数)
- `KPT`: K点采样设置
```

##### STRU 文件
```plaintext
ATOMIC_SPECIES
Fe 55.845 Fe.upf

LATTICE_CONSTANT
2.87

LATTICE_VECTORS
0.0000000000    0.5000000000    0.5000000000
0.5000000000    0.0000000000    0.5000000000
0.5000000000    0.5000000000    0.0000000000

ATOMS
Fe
0.0000000000    0.0000000000    0.0000000000
```

##### INPUT 文件
```plaintext
relax_cell = 1
force_thr_ev = 0.01
stress_thr_kbar = 0.5
max_steps = 60
calculation = "cell-relax"
symmetry = 0
ecutwfc = 100
scf_thr = 1e-07
scf_nmax = 100
smearing_sigma = 0.015
mixing_beta = 0.4
ks_solver = "genelpa"
precision = "double"
cal_force = 1
cal_stress = 1
relax_method = "cg"
relax_nmax = 60
stress_thr = 0.5
fixed_axes = "None"
nspin = 2
onsite_radius = 3
out_mul = 1
mode = "pyatb"
high_symm_points = {
  "G": [0, 0, 0],
  "H": [0, 0, 1],
  "N": [0.5, 0.5, 0]
}
energy_min = -10
energy_max = 10
insert_point_nums = 30
```

> Note: 由于 `INPUT` 文件中未出现 `dft_functional` 参数，ABACUS 默认使用赝势泛函（通常是 PBE）。PBE 泛函在带隙预测上存在一定的局限性，往往会低估实际带隙。对于需要高精度带隙预测的情况，建议使用杂化泛函或 GW 近似。

##### KPT 文件
```plaintext
kspacing = 0.14
kpath = [
  "G",
  "H",
  "N",
  "G"
]
```

> Tip: 选择的 K 点路径 `G-H-N-G` 是 bcc 结构的标准路径，它遍历了布里渊区的重要对称点，有助于全面了解材料的能带结构。

#### 计算结果
1. **带隙**: 计算得到的 bcc 铁的带隙为 0.0 eV，确认铁是一种金属。
2. **铁磁性特性**:
   - 自旋极化计算显示铁表现出铁磁性行为：
     - 由于交换相互作用，自旋向上的能带和自旋向下的能带发生分裂。
     - 自旋向上和自旋向下的费米能级不同，这是铁磁性材料的特征。
3. **计算细节**:
   - 结构：bcc 铁，初始晶格常数 a = 2.87 Å
   - 基础：LCAO（线性组合原子轨道）
   - 自旋极化：`nspin=2`，初始磁矩为 2.2 μB/Fe 原子
   - 路径：Γ-H-N-Γ（bcc 结构的标准路径）
   - 方法：PYATB 能带计算，在 ABACUS 的 SCF 计算后进行

#### 生成的文件
- **能带结构图**: `local:///tmp/abacusagent/20251224161948/2025-12-24-16:33:51.469595/54c88f0f-f688-4353-a718-050cf14e1988/outputs/band_picture/band.png`
- **能带计算目录**: `local:///tmp/abacusagent/20251224161948/2025-12-24-16:33:51.469595/54c88f0f-f688-4353-a718-050cf14e1988/outputs/band_calc_dir/20251224163328.abacus_prepare_inputs_from_relax_results.02b6fd1c.tgz`

#### 工作流总结
- 生成 bcc 铁结构，晶格常数为 2.87 Å
- 设置自旋极化计算，初始磁矩为 2.2 μB/Fe 原子
- 执行单元弛豫计算以优化结构（在 3 步内收敛）
- 沿 Γ-H-N-Γ 路径计算电子能带结构

#### 关键铁磁性特性分析
1. **金属特性**: 零带隙确认铁的金属性质，能带穿过费米能级。
2. **自旋分裂**:
   - 自旋向上能带：能量向下移动
   - 自旋向下能带：能量向上移动
   - 这种分裂是由于铁磁性材料中的交换相互作用引起的
3. **多数自旋 vs 少数自旋载流子**:
   - 在费米能级处，自旋向上的状态比自旋向下的状态多
   - 这种不平衡产生了净磁矩
4. **d 带特性**:
   - 铁的 3d 带在费米能级附近较窄
   - 自旋向上和自旋向下的 d 带之间存在强烈的交换分裂
   - 这导致了大的磁矩
5. **斯托纳准则**: 铁的铁磁性满足斯托纳准则，即费米能级处的态密度与交换相互作用的乘积大于 1。

#### 预期的能带结构特征
1. **Γ 点**: 应该显示 s 带的底部和 d 带复合体
2. **H 点**: 对理解费米表面拓扑很重要
3. **N 点**: 常常显示出 d 带结构的有趣特征

#### 磁矩分析
- 通过积分自旋向上和自旋向下态密度的差异，可以得到从能带结构计算出的磁矩。对于 bcc 铁：
  - 实验磁矩：~2.2 μB/atom
  - 初始猜测：2.2 μB/atom
  - 能带结构将显示这个磁矩是如何从自旋分裂的能带中产生的

#### 进一步分析的建议
1. **态密度 (DOS)**: 计算自旋极化的 DOS 以量化磁矩并分析轨道贡献。
2. **费米表面**: 研究费米表面拓扑，这对理解输运性质很重要。
3. **磁各向异性**: 为了完整的磁性表征，考虑计算磁各向异性能量。
4. **温度效应**: 虽然 DFT 给出的是基态性质，但考虑有限温度效应以估算居里温度也是必要的。

**注意**: 能带结构图将清楚地显示铁磁性材料的自旋分裂特征。自旋向上和自旋向下的能带将以不同的颜色（通常是红色和蓝色）绘制，显示它们由于交换相互作用而相对于彼此的位移。这是铁磁性的根本原因。

通过以上内容，读者可以全面掌握铁磁性材料的自旋极化计算方法，并深入理解其物理性质。