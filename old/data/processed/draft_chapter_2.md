## 第二章：电子基态计算

**本章逻辑**: 在建立了正确的几何模型后，下一步是计算系统的电子基态。本章将介绍自洽场（SCF）计算的基本原理和方法。

### Section 2.1: 密度泛函理论（DFT）简介

密度泛函理论（Density Functional Theory, DFT）是量子力学中的一种近似方法，用于研究多电子系统（如原子、分子和固体）的电子结构。DFT 的核心思想是通过电子密度而不是波函数来描述系统的性质。这种方法大大简化了多电子系统的计算复杂度，使其成为材料科学领域中最常用的理论工具之一。

#### Kohn-Sham 方程
DFT 的数学基础是 Hohenberg-Kohn 定理，该定理表明，对于一个给定的外部势能，系统的基态能量可以通过其电子密度唯一确定。Kohn 和 Sham 提出了一个实用的方法，即将多电子系统的哈密顿量分解为单电子哈密顿量的集合，从而引入了 Kohn-Sham 方程：

\[
\left( -\frac{\hbar^2}{2m} \nabla^2 + V_{\text{eff}}(\mathbf{r}) \right) \psi_i(\mathbf{r}) = \epsilon_i \psi_i(\mathbf{r})
\]

其中 \(V_{\text{eff}}\) 是有效势能，包括外加势能、Hartree 势能以及交换关联势能。这些方程的解提供了 Kohn-Sham 轨道 \(\psi_i\) 和相应的轨道能量 \(\epsilon_i\)。

#### 交换关联泛函
交换关联泛函 \(E_{\text{xc}}[n]\) 是 DFT 中的一个关键部分，它描述了电子间的相互作用。由于精确的交换关联泛函难以获得，通常使用近似形式，如局域密度近似（LDA）、广义梯度近似（GGA）等。这些近似方法在不同情况下表现出不同的精度，但通常都会低估带隙。

> **Note**: 当 `INPUT` 中未出现 `dft_functional` 时，ABACUS 默认使用 PBE 泛函。PBE 泛函是一种 GGA 泛函，虽然在许多情况下表现良好，但在预测带隙时往往低估实际值。

### Section 2.2: SCF 计算流程

自洽场（Self-Consistent Field, SCF）计算是 DFT 中求解 Kohn-Sham 方程的核心步骤。SCF 过程通过迭代方式逐步逼近系统的电子基态。

#### SCF 迭代过程
1. **初始猜测**：选择一组初始的 Kohn-Sham 轨道。
2. **构建有效势能**：根据当前的电子密度计算有效势能 \(V_{\text{eff}}\)。
3. **求解 Kohn-Sham 方程**：使用有效势能求解 Kohn-Sham 方程，得到新的 Kohn-Sham 轨道。
4. **更新电子密度**：利用新得到的 Kohn-Sham 轨道更新电子密度。
5. **收敛检查**：比较新旧电子密度或总能量，判断是否达到收敛标准。
6. **迭代**：如果未达到收敛标准，返回步骤 2 继续迭代。

#### 收敛标准
SCF 计算的收敛标准通常包括：
- **能量收敛**：相邻两次迭代的总能量差小于某个阈值（如 \(10^{-7}\) eV）。
- **电荷密度收敛**：相邻两次迭代的电荷密度变化小于某个阈值（如 \(10^{-6}\)）。
- **力收敛**：原子受力的模小于某个阈值（如 0.01 eV/Å）。
- **应力收敛**：晶胞应力小于某个阈值（如 0.5 kbar）。

#### 常用参数设置
以下是一些常用的 SCF 计算参数：
- `ecutwfc`：平面波截断能，决定了基组的大小。
- `scf_thr`：SCF 收敛阈值。
- `scf_nmax`：最大 SCF 迭代次数。
- `smearing_sigma`：费米面展宽参数，用于处理金属体系中的部分占据态。
- `mixing_beta`：混合系数，用于加速 SCF 收敛。

### Section 2.3: 实战演练 - 闪锌矿结构半导体

#### 案例背景
我们将以 GaAs 为例，演示如何进行 SCF 计算并分析其能带结构。GaAs 是一种典型的闪锌矿结构半导体，具有直接带隙，适合用于演示 SCF 计算及能带结构分析。

#### 输入文件配置
以下是本案例的标准 ABACUS 输入文件配置：

```plaintext
# STRU 文件
element: Ga As
lattice_constant: 5.65
crystal_type: zincblende

# INPUT 文件
mode: pyatb
high_symm_points:
  G: [0, 0, 0]
  X: [0.5, 0, 0.5]
  W: [0.5, 0.25, 0.75]
  K: [0.375, 0.375, 0.75]
energy_min: -10
energy_max: 10
insert_point_nums: 30
calculation: cell-relax
ecutwfc: 100
scf_thr: 1e-07
scf_nmax: 100
smearing_sigma: 0.015
mixing_beta: 0.8
ks_solver: genelpa
precision: double
cal_force: 1
cal_stress: 1
relax_method: cg
relax_nmax: 60
force_thr_ev: 0.01
stress_thr: 0.5
fixed_axes: None
relax_cell: 1
stress_thr_kbar: 0.5
max_steps: 60

# KPT 文件
kpath: [G, X, W, K, G]
kspacing: 0.14
```

#### 计算流程
1. **建模**：生成 GaAs 的闪锌矿结构，并设置初始晶格常数为 5.65 Å。
2. **结构弛豫**：执行结构弛豫计算，优化晶胞参数和原子位置。
3. **自洽计算**：进行 SCF 计算，求解 Kohn-Sham 方程，直到满足收敛标准。
4. **能带结构计算**：沿指定的高对称点路径（Γ-X-W-K-Γ）计算能带结构。

> **Note**: 选择的高对称点路径 Γ-X-W-K-Γ 是基于 FCC 结构的对称性。这条路径遍历了布里渊区的关键极值点，能够全面展示能带结构的特点。

#### 计算结果
- **带隙**：计算得到的 GaAs 带隙为 0.314 eV。
- **与实验值对比**：实验测得的 GaAs 带隙在室温下约为 1.42 eV。我们的计算值显著低于实验值，这是由于 PBE 泛函在带隙预测上的局限性（低估）。
- **能带结构特征**：
  - 直接带隙位于 Γ 点。
  - 价带顶附近有重空穴和轻空穴带。
  - 由于没有包含自旋-轨道耦合，分裂带未显示。

#### 关键发现
1. **直接带隙半导体**：GaAs 是一种直接带隙半导体，其价带顶和导带底均位于 Γ 点。
2. **DFT 带隙低估**：PBE 泛函计算的带隙显著低于实验值，这是 DFT 计算的典型现象。
3. **能带结构特征**：能带结构图展示了直接带隙、重空穴和轻空穴带等特征。

#### 进一步建议
1. **使用杂化泛函**：为了更准确地预测带隙，可以考虑使用杂化泛函（如 HSE06 或 PBE0），这些泛函包含一部分精确的 Hartree-Fock 交换项。
2. **包含自旋-轨道耦合**：GaAs 具有显著的自旋-轨道耦合效应，可以在计算中加入这一项以更准确地描述价带的分裂。
3. **GW 计算**：对于最准确的带隙预测，可以采用 GW 计算（多体微扰理论），尽管计算成本较高。

通过以上步骤，读者可以全面了解如何使用 ABACUS 进行 SCF 计算，并分析闪锌矿结构半导体的电子性质。