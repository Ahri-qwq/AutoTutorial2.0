<!-- META_START -->
# 《ABACUS 实战教程：晶体弹性常数计算原理与 abacustest 工作流》

## 前言
- **本书逻辑**: 本教程遵循“理论基础 -> 初始态准备 -> 自动化工作流 -> 结果分析”的物理计算逻辑。从弹性张量的定义出发，重点介绍如何利用 `abacustest` 辅助工具实现高通量的应力-应变法计算，最终通过硅（Si）的实战案例完成全流程演示。
- **核心知识点**: 弹性张量与 Voigt 记号、广义胡克定律、应力-应变法、`abacustest` 自动化工作流、晶体取向与对称性分析。

<!-- CHAPTER_START -->
## 第一章：弹性力学基础与计算原理
**本章逻辑**: 在动手计算前，必须明确“算什么”以及“怎么算”。本章建立物理图像，解释弹性张量的数学形式及其与 DFT 计算量（应力/应变）的联系。

### Section 1.1: 广义胡克定律与弹性张量
- **内容**: 介绍材料内部应力与应变的二阶张量性质，引出描述两者线性关系的四阶弹性张量 $C_{ijkl}$。
- **关键参数**: 无

### Section 1.2: Voigt 记号与对称性约化
- **内容**: 详解如何利用 Voigt 记号将 $3\times3$ 的应力/应变张量简化为 6 维向量，将 81 个分量的弹性张量简化为 $6\times6$ 对称矩阵。结合晶体对称性（以立方晶系为例），说明独立弹性常数（如 $C_{11}, C_{12}, C_{44}$）的由来。
- **关键参数**: 无

### Section 1.3: 第一性原理计算方法：应力-应变法
- **内容**: 阐述计算核心思想——通过施加一系列微小正应变和剪切应变，利用 DFT 计算对应的应力响应，进而拟合求解弹性常数矩阵。对比“固定离子（Clamped-ion）”与“松弛离子（Relaxed-ion）”计算的区别。
- **关键参数**: `cal_stress` (必须开启)

<!-- CHAPTER_START -->
## 第二章：初始结构准备与零应力优化
**本章逻辑**: 弹性常数是定义在平衡态附近的性质。本章强调“零应力”基态的重要性，并演示如何使用 `abacustest` 准备和优化初始结构。

### Section 2.1: 晶体取向与惯用胞选择
- **内容**: 强调晶体坐标系对弹性张量结果的影响。介绍为何计算弹性模量通常使用惯用胞（Conventional Cell）并将晶格矢量与笛卡尔坐标轴对齐（IEEE 标准取向）。
- **关键参数**: 无（涉及结构文件 CIF/STRU 的准备）

### Section 2.2: 生成初始结构与优化输入文件
- **内容**: 使用 Python (ase) 生成 Si 的标准惯用胞。演示如何使用 `abacustest` 的命令行功能自动生成 ABACUS 优化任务的输入文件。
- **关键参数**: `abacustest` 参数: `-f`, `--ftype`, `--jtype cell-relax`, `--lcao`, `--folder-syntax`

### Section 2.3: 执行结构优化（Cell-Relax）
- **内容**: 运行 ABACUS 进行变胞优化 (`cell-relax`)，确保残余应力收敛至忽略不计。分析优化后的 `STRU` 文件，确认晶格常数与原子位置处于基态。
- **关键参数**: `calculation`: `cell-relax`, `cal_stress`: `1`

<!-- CHAPTER_START -->
## 第三章：基于 abacustest 的弹性常数计算工作流
**本章逻辑**: 本章是核心实战部分。基于优化后的结构，详细讲解如何利用 `abacustest` 自动化生成形变结构、批量提交计算任务，演示完整的“黑盒”操作流程。

### Section 3.1: 自动生成形变任务
- **内容**: 使用 `abacustest` 基于优化后的结构文件，一键生成包含正应变和剪切应变的系列输入文件夹。详细解释应变幅度参数的选择原则。
- **关键参数**: `abacustest` 参数: `--norm` (默认 0.01), `--shear` (默认 0.01), `--norelax` (可选，决定是否优化原子位置)

### Section 3.2: 理解变形计算的参数设置
- **内容**: 剖析生成的 `INPUT` 文件。重点解释为何对变形后的结构通常进行固定晶胞的原子弛豫 (`relax`) 而非仅做电子步自洽 (`scf`)，以及必须开启的应力计算开关。
- **关键参数**: `calculation`: `relax` (或 `scf`), `cal_stress`: `1`, `cal_force`: `1` (若做 relax), `esolver_type`: `ks`

### Section 3.3: 批量提交与任务管理
- **内容**: 介绍生成的目录结构（`deform-xxx` 文件夹），演示如何批量提交所有应变模式的 ABACUS 计算任务，并监控计算进度。
- **关键参数**: 无（涉及 Shell 脚本或作业调度系统）

<!-- CHAPTER_START -->
## 第四章：数据后处理与结果物理分析
**本章逻辑**: 计算完成后，需要将原本离散的应力数据转化为物理常数。本章讲解拟合过程、结果验证及宏观力学性质的推导。

### Section 4.1: 自动化拟合与弹性张量输出
- **内容**: 使用 `abacustest` 的后处理命令，读取各子文件夹中的应力数据，拟合得到完整的弹性张量矩阵。
- **关键参数**: `abacustest` 后处理相关命令

### Section 4.2: 宏观力学模量的推导
- **内容**: 基于计算出的 $C_{ij}$ 矩阵，解析输出结果中的体模量 ($B$)、剪切模量 ($G$)、杨氏模量 ($E$) 和泊松比 ($\nu$)。解释 Voigt-Reuss-Hill 平均近似的含义。
- **关键参数**: 无

### Section 4.3: 结果验证与对比
- **内容**: 将计算得到的 Si 弹性常数（$C_{11}, C_{12}, C_{44}$）与 Materials Project 数据库或实验值进行对比，评估计算精度（如赝势、基组、k点的影响）。
- **关键参数**: 无

<!-- APPENDIX_START -->
## 附录：常见问题与进阶建议
- **常见报错**: `cal_stress` 未开启导致的拟合失败；应变范围过大或过小导致的非线性误差。
- **进阶技巧**: 如何处理低对称性晶体；如何进行 Born 稳定性判据分析；K 点密度对弹性常数精度的敏感性分析。
- **工具链**: `abacustest` 与 `ase`/`pymatgen` 的关系厘清。