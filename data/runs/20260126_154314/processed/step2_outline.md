<!-- META_START -->
# ABACUS 实战教程：Berry Phase 与铁电极化计算

## 前言
- **本书逻辑**: 本教程遵循“理论物理背景 -> 标准计算流程 -> 结果后处理与分析”的教学逻辑。从现代极化理论的物理本质出发，详细拆解 ABACUS 中“SCF + NSCF”的两步计算法，重点攻克极化量子多值性（Modulo Quantum）这一数据分析难点。
- **核心知识点**: Berry Phase（贝里相位）、Modern Theory of Polarization（现代极化理论）、自洽与非自洽计算流程、LCAO 基组下的极化计算、自发极化强度（Spontaneous Polarization）的处理。

<!-- CHAPTER_START -->
## 第一章：物理基础与现代极化理论
**本章逻辑**: 计算铁电极化不同于简单的电荷密度积分，必须先理解“贝里相位”这一拓扑概念。本章旨在为读者建立正确的物理图像，理解为何周期性体系的极化是多值的，从而避免后续数据分析中的原则性错误。

### Section 1.1: 周期性体系极化的困境
- **内容**: 阐述为何在周期性边界条件（PBC）下，传统的 $\sum q \mathbf{r}$ 定义失效。介绍 Clausius-Mossotti 关系的局限性。
- **关键参数**: 无

### Section 1.2: 贝里相位与极化量子
- **内容**: 引入 Berry Phase 概念，解释极化强度 $P$ 与波函数在倒空间绝热演化的关系。重点解释 **Polarization Quantum (极化量子)** 和 **Modulo $2\pi$** 的多值特性（即计算结果 $P$ 与 $P + n \cdot P_{quant}$ 等价）。
- **关键参数**: 无

<!-- CHAPTER_START -->
## 第二章：ABACUS 计算流程详解
**本章逻辑**: 这是本教程的核心操作部分。基于 ABACUS 的 LCAO 基组，详细演示从结构准备到 Berry Phase 计算的完整工作流。强调“分步计算”的重要性。

### Section 2.1: 体系建模与对称性检查
- **内容**: 以典型铁电体（如 PbTiO$_3$ 或 BaTiO$_3$）为例，准备 `STRU` 文件。
- **重要提示**: 强调计算铁电极化必须使用**破坏中心反演对称性**的结构。若结构具有中心反演对称性，极化值理论应为 0（或模数）。
- **关键参数**: `STRU` 文件中的晶格与原子坐标。

### Section 2.2: 第一步：自洽计算 (SCF)
- **内容**: 进行标准的自洽场计算，获取收敛的基态电荷密度。这是后续计算贝里相位的物理基础。
- **关键参数**:
    - `calculation`: `scf`
    - `basis_type`: `lcao` (根据素材推荐)

### Section 2.3: 第二步：非自洽 Berry Phase 计算 (NSCF)
- **内容**: 读取上一步的电荷密度，开启 Berry Phase 模块进行非自洽计算。
- **关键参数**:
    - `calculation`: `nscf`
    - `berry_phase`: `1` (或 `true`，开启计算)
    - **极化方向控制**: 待定(需查阅文档)。*注：素材提示需指定方向，通常涉及 `KPT` 文件中沿特定倒格矢方向的路径设置，或特定的输入参数。需在撰写时查证是否通过 K 点串（String of k-points）控制。*

<!-- CHAPTER_START -->
## 第三章：结果分析与自发极化计算
**本章逻辑**: 获得原始数据只是第一步，如何从多值的 Berry Phase 中提取出物理上唯一的“自发极化强度”是初学者最大的难点。本章通过实例演示数据后处理方法。

### Section 3.1: 原始输出数据的解读
- **内容**: 解释 ABACUS 输出文件中的 Berry Phase 值（通常单位为电子相位或 C/m$^2$）。
- **关键参数**: 输出文件中的极化值关键词（需结合实际算例输出）。

### Section 3.2: 极化量子的确定与分支选择
- **内容**: 演示如何计算体系的极化量子（Polarization Quantum）。讲解如何利用参考相（如顺电相）与铁电相进行对比，通过绝热路径（Adiabatic Path）连接不同结构下的极化值，消除模数歧义。
- **关键参数**: 无

### Section 3.3: 计算自发极化强度 ($P_s$)
- **内容**: 综合上述步骤，计算 $P_s = P_{ferro} - P_{para}$。讨论 Born Effective Charge 的变化对结果的影响（参考素材中提到的 Scaling 问题）。
- **关键参数**: 无

<!-- APPENDIX_START -->
## 附录：常见问题与进阶建议
- **K点收敛性**: 提醒 Berry Phase 计算对 K 点网格（尤其是沿极化方向的密度）非常敏感。
- **金属体系警告**: 明确指出 Berry Phase 极化计算仅适用于绝缘体或半导体；对于金属体系（如 bcc Fe），虽然涉及 Berry Curvature 但主要用于计算反常霍尔电导（AHC），而非电极化。
- **参数缺失风险**: 再次提醒读者关于“极化方向”设置的具体参数需参照最新版 ABACUS 官方文档。