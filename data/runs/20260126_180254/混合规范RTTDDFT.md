# 混合规范RT-TDDFT——兼具效率和精度的算法创新

> 来源: https://mp.weixin.qq.com/s/uMg2jMgDSzrP1VYqLhobog

近日，中国科学技术大学在读博士生赵昊天与何力新教授在国产开源密度泛函理论软件 ABACUS（原子算筹）中，提出并实现了一种适用于原子轨道基组的混合规范实时含时密度泛函理论（Hybrid gauge real-time time-dependent density functional theory, Hybrid gauge rt-TDDFT）。该方法在传统速度规范的基础上，引入矢势依赖的时变相位，有效克服了由局域基组不完备性导致的系统性误差，能够在周期性与非周期性体系中提供一致可靠的模拟结果。同时，该方法大幅提升了周期性体系中的计算效率，为电场作用下的第一性原理实时动力学模拟提供了一种兼具精度与效率的新方案。

实时含时密度泛函理论（rt-TDDFT）是研究材料在激发态及外场驱动下电子动力学行为的重要理论方法，广泛应用于非线性光学响应、超快光谱以及电荷与能量输运等前沿领域。相比线性响应方法，rt-TDDFT能够直接追踪电子在时间演化过程中的量子动力学轨迹，尤其适用于强场激发和远离平衡态的非线性过程，因此已成为研究光与物质相互作用、载流子弛豫等现象的关键手段。然而，在周期性体系中开展rt-TDDFT计算仍面临挑战。传统速度规范（velocity gauge）在数值原子轨道（NAO）基组下的直接应用，忽略了由矢量势引起的轨道内部相位变化，从而导致系统性误差，严重影响了电流响应与非线性光学等关键物理量的计算精度。为解决这一问题，赵昊天和何力新提出了混合规范（hybrid gauge）算法，通过显式引入矢势诱导的局域相位修正，有效克服了速度规范在局域基组中的局限性，并构建了一个既严谨又高效的理论框架，为周期性体系中的超快电子动力学研究提供了新的解决方案。

在rt-TDDFT中，我们可以通过在哈密顿量中加入一个时间相关的外场项，来模拟体系在电场等外界激励下的动态响应。其中最常用的是**长度规范**，它的哈密顿量形式较为简单，仅包含一个额外的标量势项：

其中 是体系本身的哈密顿量， 描述的是电场与电子的相互作用。相应的含时 Kohn-Sham 方程为：

其中， 表示在Kohn-Sham 有效势，包括电子-离子相互作用、Hartree 势、交换-相关势等。长度规范适用于非周期性体系，但在周期性体系中，该形式破坏了系统的周期性结构，因此**无法直接应用于晶体材料**等具有周期性势场的计算中。

为了解决这个问题，人们通常采用**规范变换**的方式，将哈密顿量转化为**速度规范**（velocity gauge）形式。电场由时间依赖的矢量势 导出：

速度规范下的哈密顿量为：

其运动方程为：

理论上，长度规范与速度规范本质上是等价的，二者之间可通过如下的规范变换实现互相转换：

但在实际计算中，由于我们使用的是有限维基组（如原子轨道），这个相位关系不能被完美表达，导致两种规范下计算结果出现偏差。例如，在原子轨道基组下，长度规范和速度规范的波函数都写成了原子轨道线性组合（LCAO）的形式：

但显然，速度规范下的波函数表达形式忽略了原子轨道内部由矢量势引起的相位变化，进而在模拟中引入系统性误差，尤其在电流和能量等关键物理量的计算中表现得尤为明显。尽管可以通过增大基组来减少误差，但这会显著提高计算成本，严重制约了 rt-TDDFT 在周期性体系中的应用效率。

为补偿规范变换所引入的相位效应，我们在每个原子轨道前引入了一个依赖于矢量势的相位因子：

其中， 是原子轨道的中心位置。波函数的形式为：

在这个相位修正下，最终可以得到哈密顿量矩阵和轨道的交叠矩阵为：

上述变换可视为一种规范变换。由于该规范中同时包含矢量势 和标量场 ，我们将其称为混合规范。混合规范下的哈密顿量形式虽类似于长度规范，但其外场项 保持周期性不变，规避了长度规范在周期性体系中破坏布洛赫定理的缺陷，同时保留了其计算简单的优点。与速度规范相比，混合规范在计算效率上也具有显著优势，它在处理非局域势时更加高效。其他物理量，如电荷密度和电流密度，也可通过类似的方式进行处理。由于混合规范与长度规范之间满足严格的规范变换关系，两者的计算结果在理论上是完全等价的。

对于非周期性体系，三种规范都可以适用。上图展示了 HCO 分子在高斯脉冲激发下产生的响应电流及其对应的吸收谱。可以看出，长度规范与混合规范给出的结果完全一致，验证了两者在理论上的等价性。相比之下，速度规范计算得到的响应电流与长度规范和混合规范存在明显偏差，尤其其对应的光谱在低频区域表现出显著的发散行为，反映出速度规范在局域基组下所引入的系统性误差。尽管该误差可通过增加基组规模加以缓解，但随之而来的计算成本也大幅提升。为此，作者提出了一种经验性的修正方法，可在保持较低计算开销的前提下，显著降低速度规范带来的误差。

为了测试混合规范在周期性体系以及强场下的适用性，我们也测试了Si体系的线性响应和非线性响应行为。

上图展示了 Si 单胞在 脉冲激发下的响应电流及其对应的介电函数。从结果可以看出，速度规范存在明显的系统性误差，但通过我们提出的修正方案，该误差能够得到有效缓解。相比之下，混合规范则能够稳定地给出更加准确且物理一致的结果。

上图展示了 Si 单胞在强高斯脉冲激发下的响应电流及其对应的高次谐波谱。随着最大场强从 增强至 ，电流信号逐渐偏离外加场的基频，表现出日益增强的非线性响应特征，同时在高次谐波谱中依次出现了 1、3、5、7 次谐波信号。

上述结果表明，混合规范在非周期与周期体系、强场与弱场扰动等不同物理情形下均适用，具备良好的通用性和准确性。相较于速度规范，其在周期性体系中展现出更高的计算精度与效率，能够在小基组条件下实现稳定可靠的实时动力学模拟，为后续基于 NAO 的 rt-TDDFT 方法开发提供了坚实的理论与技术支撑。

本文提出并实现了一种基于原子轨道基组的混合规范实时含时密度泛函理论（Hybrid gauge rt-TDDFT），有效克服了速度规范在局域基组下存在的系统性误差问题，在非周期与周期体系、强场与弱场等多种物理条件下均展现出优异的精度与计算效率。该方法不仅为小基组下的实时电子动力学模拟提供了可靠手段，也为国产第一性原理软件 ABACUS 的进一步发展与拓展奠定了坚实基础。

相关成果近日发表在 *Journal of Chemical Theory and Computation*上，论文链接如下：🔗 https://doi.org/10.1021/acs.jctc.5c00111

**扫码关注“ABACUS”**