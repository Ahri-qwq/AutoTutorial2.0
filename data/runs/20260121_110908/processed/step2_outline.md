<!-- META_START -->
# ABACUS 实战教程：晶体弹性常数计算与力学性质分析

## 前言
- **本书逻辑**: 本教程遵循“物理原理 -> 模型准备 -> 自动化工作流 -> 数据分析”的逻辑闭环。从广义胡克定律出发，明确DFT计算弹性张量的物理图景；重点讲解如何使用 ABACUS 结合 `abacustest` 工具自动化完成“施加应变-计算应力-拟合张量”的标准流程；最后深入解读输出数据，确保读者不仅能算出数，还能读懂物理含义。
- **核心知识点**: 广义胡克定律、应力-应变法、Voigt 记号、晶胞优化（Zero-stress state）、`abacustest` 工作流、弹性模量（体模量/剪切模量/杨氏模量）分析。

<!-- CHAPTER_START -->
## 第一章：弹性力学基础与 DFT 计算原理
**本章逻辑**: 在动手计算前，必须建立物理图像。本章不涉及具体代码，而是明确“我们在算什么”，解释为什么通过计算微观的应力-应变关系可以得到宏观的力学常数。

### Section 1.1: 广义胡克定律与 Voigt 记号
- **内容**: 介绍弹性张量（Stiffness Tensor, $C_{ijkl}$）的定义。解释如何利用晶体对称性和 Voigt 记号将复杂的四阶张量简化为 $6\times6$ 矩阵（如立方晶系的 3 个独立分量）。
- **关键参数**: 无

### Section 1.2: 应力-应变法 (Stress-Strain Method)
- **内容**: 阐述 DFT 计算弹性常数的核心思想——通过施加一组预定义的微小应变（正应变和剪切应变），计算对应的柯西应力张量，通过线性拟合求解 $C_{ij}$。
- **关键参数**: 无

<!-- CHAPTER_START -->
## 第二章：计算准备：构建“零应力”基准态
**本章逻辑**: 弹性常数是二阶导数性质，对初始结构的残余应力非常敏感。本章重点讲解如何获得一个合格的初始结构，这是所有后续计算准确性的基石。

### Section 2.1: 晶胞选取策略：原胞还是惯用胞？
- **内容**: 讨论不同晶系下晶胞的选择。特别强调对于立方晶系（如 Si, Cu），推荐使用**惯用胞 (Conventional Cell)** 以确保 $C_{ij}$ 矩阵符合标准形式，避免复杂的张量旋转。
- **关键参数**: 无（涉及建模工具如 ASE/pymatgen）

### Section 2.2: 初始结构的深度优化
- **内容**: 讲解如何使用 ABACUS 进行高精度的晶胞弛豫（Variable-cell relaxation），确保初始结构处于能量极小值且残余应力接近于零。
- **关键参数**: 
    - `calculation`: `cell-relax` (必须使用变胞优化)
    - `cal_stress`: `1` (必须开启应力计算)
    - `cal_force`: `1`
    - `esolver_type`: `ks`

<!-- CHAPTER_START -->
## 第三章：自动化流程：使用 abacustest 计算弹性张量
**本章逻辑**: 这是本教程的核心实操部分。采用官方推荐的 `abacustest` 工具，演示从生成变形结构到结果拟合的全自动化工作流，替代繁琐的手工操作。

### Section 3.1: 流程概览与环境配置
- **内容**: 介绍 `abacustest` 的弹性计算模块结构，以及所需的 Python 环境（pymatgen, ase 等）准备。
- **关键参数**: 无

### Section 3.2: 步骤一：生成变形结构 (Deformation Generation)
- **内容**: 演示如何使用命令行工具自动生成施加了不同大小正应变和剪切应变的 ABACUS 输入文件夹。详细解释应变步长和范围的选择逻辑。
- **关键参数**: 
    - `abacustest` 命令行参数: `--norm` (最大正应变，如 0.01), `--shear` (最大剪切应变)
    - INPUT 参数（由脚本自动生成）: `calculation` (设为 `relax` 或 `scf`)

### Section 3.3: 步骤二：批量提交与应力计算
- **内容**: 讲解如何批量运行生成的任务。重点区分两种计算模式：
    1. **Relaxed Ions (推荐)**: 允许原子内部弛豫 (`calculation: relax`)，对应绝热弹性常数。
    2. **Clamped Ions**: 原子坐标固定 (`calculation: scf` / `abacustest --norelax`)，对应高频极限。
- **关键参数**: 
    - `calculation`: `relax` (通常情况) 或 `scf` (若使用 --norelax)
    - `cal_stress`: `1` (核心参数，必须开启)
    - `symmetry`: `0` (可能需要关闭对称性以防止强制对称化影响结果)

### Section 3.4: 步骤三：数据后处理与拟合
- **内容**: 使用 `abacustest` 收集所有子任务的应力数据，拟合得到弹性刚度矩阵 $C_{ij}$。
- **关键参数**: 
    - `abacustest` 后处理命令

<!-- CHAPTER_START -->
## 第四章：结果分析与力学性质导出
**本章逻辑**: 得到 $C_{ij}$ 矩阵只是中间结果，本章指导读者如何验证结果的可靠性，并将其转化为具体的物理模量。

### Section 4.1: 弹性矩阵的对称性与稳定性验证
- **内容**: 检查输出矩阵是否符合晶体所属点群的对称性要求（例如立方晶系 $C_{11}, C_{12}, C_{44}$ 是否主导，其余项是否接近 0）。介绍 Born 稳定性判据（Born stability criteria）。
- **关键参数**: 无

### Section 4.2: 宏观模量的计算 (Voigt-Reuss-Hill 近似)
- **内容**: 基于 $C_{ij}$ 计算体模量 ($B$)、剪切模量 ($G$)、杨氏模量 ($E$) 和泊松比 ($\nu$)。解释 Voigt 上界和 Reuss 下界的物理含义。对比 Materials Project 数据库结果。
- **关键参数**: 无

<!-- APPENDIX_START -->
## 附录：常见问题与进阶建议
- **K点与截断能收敛性**: 强调弹性常数对计算精度的高敏感性。
- **应力单位换算**: kBar vs GPa 的坑点。
- **负弹性常数**: 出现非物理结果的排查思路（基组精度、结构未优化、对称性破缺）。
- **IEEE 标准取向**: 为何有时计算结果与文献不一致？（晶体旋转轴定义问题）。