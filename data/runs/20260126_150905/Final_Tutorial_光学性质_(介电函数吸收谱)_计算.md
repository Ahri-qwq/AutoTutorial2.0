# å…‰å­¦æ€§è´¨ (ä»‹ç”µå‡½æ•°/å¸æ”¶è°±) è®¡ç®— å®æˆ˜æ•™ç¨‹

## å‰è¨€
ï¼ˆè‡ªåŠ¨ç”Ÿæˆçš„å‰è¨€è§£æå¤±è´¥ï¼Œè¯·æ‰‹åŠ¨è¡¥å……ï¼‰

---

# ç¬¬ä¸€ç« ï¼šçº¿æ€§å…‰å­¦æ€§è´¨è®¡ç®—åŸç†

åœ¨å¼€å§‹å…·ä½“çš„ä»£ç æ“ä½œä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å»ºç«‹æ¸…æ™°çš„ç‰©ç†å›¾åƒã€‚è®¡ç®—ææ–™çš„å…‰å­¦æ€§è´¨ï¼Œæœ¬è´¨ä¸Šæ˜¯æ±‚è§£å…‰ï¼ˆç”µç£æ³¢ï¼‰ä¸ææ–™ä¸­ç”µå­çš„ç›¸äº’ä½œç”¨ã€‚

æœ¬ç« å°†å¸¦ä½ ç†è§£è¿™ä¸€è¿‡ç¨‹çš„ä¸¤ä¸ªæ ¸å¿ƒç¯èŠ‚ï¼š
1.  **å®è§‚å±‚é¢**ï¼šå¦‚ä½•é€šè¿‡ä»‹ç”µå‡½æ•°ï¼ˆDielectric Functionï¼‰æ¨å¯¼å‡ºæŠ˜å°„ç‡ã€å¸æ”¶ç³»æ•°ç­‰å®éªŒå¯æµ‹é‡çš„å…‰å­¦å¸¸æ•°ã€‚
2.  **å¾®è§‚å±‚é¢**ï¼šABACUS å¦‚ä½•åˆ©ç”¨åŸå­è½¨é“ï¼ˆLCAOï¼‰åŸºç»„æ„å»ºç´§æŸç¼šæ¨¡å‹ï¼Œå¹¶å°†ç”µå­ç»“æ„ä¿¡æ¯ä¼ é€’ç»™åå¤„ç†å·¥å…· `pyatb` è¿›è¡Œå…‰å¯¼ç‡è®¡ç®—ã€‚

---

## 1.1 ä»‹ç”µå‡½æ•°ä¸å®è§‚å…‰å­¦å¸¸æ•°

åœ¨çº¿æ€§å“åº”ç†è®ºä¸­ï¼Œææ–™å¯¹å…‰çš„å“åº”å®Œå…¨ç”±å¤ä»‹ç”µå‡½æ•° $\epsilon(\omega)$ æè¿°ï¼š

$$
\epsilon(\omega) = \epsilon_1(\omega) + i\epsilon_2(\omega)
$$

### 1.1.1 ç‰©ç†æ„ä¹‰
*   **è™šéƒ¨ $\epsilon_2(\omega)$ï¼ˆå¸æ”¶é¡¹ï¼‰**ï¼šç›´æ¥å¯¹åº”ç”µå­åœ¨èƒ½çº§é—´çš„è·ƒè¿ã€‚å½“å…‰å­çš„èƒ½é‡ $\hbar\omega$ ç­‰äºå¯¼å¸¦ä¸ä»·å¸¦çš„èƒ½é‡å·®æ—¶ï¼Œç”µå­å¸æ”¶å…‰å­èƒ½é‡å‘ç”Ÿè·ƒè¿ï¼Œäº§ç”Ÿå¸æ”¶å³°ã€‚è¿™æ˜¯æˆ‘ä»¬è®¡ç®—çš„**èµ·ç‚¹**ã€‚
*   **å®éƒ¨ $\epsilon_1(\omega)$ï¼ˆè‰²æ•£é¡¹ï¼‰**ï¼šæè¿°ææ–™çš„æåŒ–ç¨‹åº¦å’ŒæŠ˜å°„è¡Œä¸ºã€‚å®ƒå¹¶ä¸ç›´æ¥é€šè¿‡æ³¢å‡½æ•°è®¡ç®—ï¼Œè€Œæ˜¯é€šè¿‡ **Kramers-Kronig (K-K) å…³ç³»** ç”±è™šéƒ¨ $\epsilon_2(\omega)$ æ¨å¯¼è€Œæ¥ã€‚

### 1.1.2 å¯¼å‡ºå…¶ä»–å…‰å­¦æ€§è´¨
ä¸€æ—¦æˆ‘ä»¬è®¡ç®—å‡ºäº† $\epsilon_1(\omega)$ å’Œ $\epsilon_2(\omega)$ï¼Œæ‰€æœ‰å…¶ä»–çš„çº¿æ€§å…‰å­¦æ€§è´¨éƒ½å¯ä»¥é€šè¿‡ç®€å•çš„ä»£æ•°å…³ç³»å¾—åˆ°ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬åœ¨è®¡ç®—æµç¨‹ä¸­åªå…³æ³¨ä»‹ç”µå‡½æ•°çš„åŸå› ã€‚

ä»¥ä¸‹æ˜¯å¸¸ç”¨å…‰å­¦å¸¸æ•°çš„æ¨å¯¼å…¬å¼ï¼š

1.  **æŠ˜å°„ç‡ (Refractive Index, $n$)**ï¼š
    $$ n(\omega) = \sqrt{\frac{\sqrt{\epsilon_1^2 + \epsilon_2^2} + \epsilon_1}{2}} $$
2.  **æ¶ˆå…‰ç³»æ•° (Extinction Coefficient, $\kappa$)**ï¼š
    $$ \kappa(\omega) = \sqrt{\frac{\sqrt{\epsilon_1^2 + \epsilon_2^2} - \epsilon_1}{2}} $$
3.  **å¸æ”¶ç³»æ•° (Absorption Coefficient, $\alpha$)**ï¼š
    $$ \alpha(\omega) = \frac{2\omega}{c}\kappa(\omega) = \sqrt{\frac{2\omega^2}{c^2} \left( \sqrt{\epsilon_1^2 + \epsilon_2^2} - \epsilon_1 \right)} $$
    > **æ³¨æ„**ï¼šè¿™é‡Œçš„å•ä½æ¢ç®—è‡³å…³é‡è¦ï¼Œæˆ‘ä»¬å°†åœ¨ 1.3 èŠ‚è¯¦ç»†è®¨è®ºã€‚
4.  **åå°„ç‡ (Reflectivity, $R$)**ï¼ˆæ­£å…¥å°„æƒ…å†µï¼‰ï¼š
    $$ R(\omega) = \frac{(n-1)^2 + \kappa^2}{(n+1)^2 + \kappa^2} $$
5.  **èƒ½é‡æŸå¤±å‡½æ•° (Energy Loss Function, $L$)**ï¼š
    $$ L(\omega) = \text{Im}\left(-\frac{1}{\epsilon(\omega)}\right) = \frac{\epsilon_2}{\epsilon_1^2 + \epsilon_2^2} $$

---

## 1.2 åŸºäº LCAO çš„ç´§æŸç¼šæ¨¡å‹ä¸å·¥ä½œæµ

ABACUS çš„ä¸€å¤§ç‰¹è‰²æ˜¯æ”¯æŒæ•°å€¼åŸå­è½¨é“ï¼ˆLCAOï¼‰åŸºç»„ã€‚åœ¨è®¡ç®—å…‰å­¦æ€§è´¨æ—¶ï¼Œæˆ‘ä»¬é‡‡ç”¨**â€œä¸¤æ­¥èµ°â€**ç­–ç•¥ã€‚

### 1.2.1 æ ¸å¿ƒæµç¨‹ï¼šä» DFT åˆ° Tight-Binding
è®¡ç®—å…‰å­¦æ€§è´¨éœ€è¦æ±‚å’Œå¸ƒé‡Œæ¸ŠåŒºä¸­å¤§é‡çš„ $k$ ç‚¹ä»¥ä¿è¯ç§¯åˆ†ç²¾åº¦ã€‚ç›´æ¥ä½¿ç”¨ DFT è¿›è¡Œå…¨å¸ƒé‡Œæ¸ŠåŒºè®¡ç®—æå…¶æ˜‚è´µã€‚
ABACUS çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼š
1.  **Step 1 (ABACUS)**ï¼šåœ¨ç¨€ç– $k$ ç‚¹ç½‘æ ¼ä¸Šè¿›è¡Œè‡ªæ´½è®¡ç®—ï¼ˆSCFï¼‰ï¼Œå¾—åˆ°å®ç©ºé—´çš„å“ˆå¯†é¡¿é‡çŸ©é˜µ ($H$)ã€é‡å çŸ©é˜µ ($S$) å’Œä½ç½®ç®—ç¬¦çŸ©é˜µ ($r$)ã€‚
2.  **Step 2 (pyatb)**ï¼šåˆ©ç”¨è¿™äº›çŸ©é˜µæ„å»ºç´§æŸç¼šï¼ˆTight-Bindingï¼‰æ¨¡å‹ï¼Œåˆ©ç”¨ Wannier æ’å€¼æŠ€æœ¯å¿«é€Ÿå¾—åˆ°ä»»æ„å¯†é›†çš„ $k$ ç‚¹ä¸Šçš„æœ¬å¾å€¼å’Œæ³¢å‡½æ•°ï¼Œè¿›è€Œè®¡ç®— Kubo-Greenwood å…¬å¼ã€‚

### 1.2.2 å…³é”®çŸ©é˜µä¸å‚æ•°è®¾ç½®
ä¸ºäº†è®© ABACUS è¾“å‡º Step 2 æ‰€éœ€çš„çŸ©é˜µï¼Œå¿…é¡»åœ¨ `INPUT` æ–‡ä»¶ä¸­æ˜¾å¼å¼€å¯ä»¥ä¸‹å‚æ•°ï¼š

| å‚æ•°å | æ¨èå€¼ | ç‰©ç†å«ä¹‰ |
| :--- | :--- | :--- |
| `out_mat_hs2` | `1` | è¾“å‡ºäºŒé˜¶å“ˆå¯†é¡¿çŸ©é˜µ ($H$) å’Œé‡å çŸ©é˜µ ($S$)ã€‚ç”Ÿæˆæ–‡ä»¶é€šå¸¸ä¸º `data-HR-sparse_SPIN0.csr` å’Œ `data-SR-sparse_SPIN0.csr`ã€‚ |
| `out_mat_r` | `1` | è¾“å‡ºä½ç½®ç®—ç¬¦ï¼ˆå¶æï¼‰çŸ©é˜µ ($r$)ã€‚è¿™æ˜¯è®¡ç®—å…‰å­¦è·ƒè¿çŸ©é˜µå…ƒ $\langle n\mathbf{k}|\mathbf{r}|m\mathbf{k}\rangle$ çš„åŸºç¡€ã€‚ç”Ÿæˆæ–‡ä»¶ä¸º `data-rR-sparse.csr`ã€‚ |
| `basis_type` | `lcao` | å¿…é¡»ä½¿ç”¨åŸå­è½¨é“åŸºç»„ã€‚ |

> **é£é™©æç¤º**ï¼šé»˜è®¤æƒ…å†µä¸‹ `out_mat_*` å‚æ•°å‡ä¸º 0ã€‚å¦‚æœä½ å¿˜è®°è®¾ç½®å®ƒä»¬ä¸º 1ï¼ŒABACUS è®¡ç®—ç»“æŸåå°†ä¸ä¼šç”Ÿæˆä»»ä½•çŸ©é˜µæ–‡ä»¶ï¼Œå¯¼è‡´åç»­ pyatb æ— æ³•è¿è¡Œã€‚

### 1.2.3 æ•°æ®çš„â€œæ‰‹åŠ¨â€ä¼ é€’ (Critical)
è¿™æ˜¯æ–°æ‰‹æœ€å®¹æ˜“å‡ºé”™çš„ç¯èŠ‚ã€‚`pyatb` ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„åå¤„ç†å·¥å…·ï¼Œå®ƒ**ä¸èƒ½**è‡ªåŠ¨è¯»å– ABACUS çš„äºŒè¿›åˆ¶è¾“å‡ºæˆ–æ—¥å¿—æ–‡ä»¶æ¥è·å–è´¹ç±³èƒ½çº§å’Œå æ®æ€ä¿¡æ¯ã€‚

**ä½ å¿…é¡»æ‰‹åŠ¨å®Œæˆä»¥ä¸‹æ•°æ®çš„ä¼ é€’ï¼š**

1.  **æŸ¥æ‰¾æ•°æ®**ï¼š
    æ‰“å¼€ ABACUS çš„æ ‡å‡†è¾“å‡ºæ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯å±å¹•è¾“å‡ºé‡å®šå‘çš„æ–‡ä»¶ï¼Œæˆ– `OUT.*/running_scf.log`ï¼‰ï¼Œåœ¨æ–‡ä»¶æœ«å°¾å¯»æ‰¾ä»¥ä¸‹å…³é”®è¯ï¼š
    *   `occupied bands`: ä½“ç³»çš„å æ®èƒ½å¸¦æ•°ã€‚
    *   `E_Fermi`: è´¹ç±³èƒ½çº§ï¼ˆé€šå¸¸å•ä½ä¸º eVï¼Œä½†ä¹Ÿå¯èƒ½æ˜¯ Ryï¼Œéœ€æ ¸å¯¹ `running_scf.log` ä¸­çš„å•ä½è¯´æ˜ï¼Œé€šå¸¸ ABACUS è¾“å‡º eVï¼‰ã€‚

2.  **å¡«å…¥ pyatb**ï¼š
    å°†ä¸Šè¿°æ•°å€¼å‡†ç¡®å¡«å…¥ `pyatb` çš„ `Input` æ–‡ä»¶ä¸­ï¼š
    ```text
    OPTICAL_CONDUCTIVITY
    {
     occ_band  [å¡«å…¥ occupied bands çš„æ•°å€¼]
     ...
    }
    
    INPUT_PARAMETERS
    {
     fermi_energy [å¡«å…¥ E_Fermi çš„æ•°å€¼]
     fermi_energy_unit eV
     ...
    }
    ```

> **è­¦å‘Š**ï¼šå¦‚æœè´¹ç±³èƒ½çº§å¡«å†™é”™è¯¯ï¼Œä¼šå¯¼è‡´å¸¦é—´è·ƒè¿çš„å æ®æ•°åˆ¤æ–­é”™è¯¯ï¼ˆ$f_{nk}-f_{mk}$ï¼‰ï¼Œä»è€Œè®¡ç®—å‡ºå®Œå…¨é”™è¯¯çš„ä»‹ç”µå‡½æ•°è°±ã€‚

### 1.2.4 æ™¶æ ¼ä¿¡æ¯çš„è¡¥å……
`pyatb` ç›®å‰ç‰ˆæœ¬ä¸ä¼šè‡ªåŠ¨ä» `.csr` ç¨€ç–çŸ©é˜µæ–‡ä»¶ä¸­è¯»å–æ™¶æ ¼å¸¸æ•°å’Œæ™¶æ ¼çŸ¢é‡ã€‚ä½ å¿…é¡»åœ¨ `pyatb` çš„ `Input` æ–‡ä»¶ä¸­æ˜¾å¼æ·»åŠ  `LATTICE` å—ï¼Œå†…å®¹åº”ä¸ ABACUS çš„ `STRU` æ–‡ä»¶ä¿æŒä¸€è‡´ï¼ˆæ³¨æ„å•ä½é€šå¸¸æ˜¯ Bohrï¼‰ã€‚

---

## 1.3 åå¤„ç†ä¸­çš„å•ä½æ¢ç®—é€»è¾‘

åœ¨ Step 2 å®Œæˆåï¼Œ`pyatb` ä¼šè¾“å‡ºä»‹ç”µå‡½æ•°çš„å®éƒ¨å’Œè™šéƒ¨ã€‚ä½†åœ¨ç»˜åˆ¶**å¸æ”¶ç³»æ•° (Absorption Coefficient)** å›¾è°±æ—¶ï¼Œç›´æ¥å¥—ç”¨å…¬å¼ä¼šé‡åˆ°å•ä½é—®é¢˜ã€‚

é€šå¸¸è®¡ç®—å¾—åˆ°çš„èƒ½é‡ $E$ å•ä½æ˜¯ eVï¼Œè€Œå®éªŒå¸¸ç”¨çš„å¸æ”¶ç³»æ•°å•ä½æ˜¯ $\text{cm}^{-1}$ã€‚

**æ ‡å‡†æ¢ç®—æµç¨‹**ï¼š

å…¬å¼ï¼š$\alpha(E) = \frac{E}{\hbar c} \sqrt{2 \left( \sqrt{\epsilon_1^2 + \epsilon_2^2} - \epsilon_1 \right)}$

1.  **å¸¸æ•°å‡†å¤‡**ï¼š
    *   æ™®æœ—å…‹å¸¸æ•° $\hbar \approx 4.1357 \times 10^{-15} \text{ eV}\cdot\text{s}$
    *   å…‰é€Ÿ $c \approx 3.0 \times 10^{10} \text{ cm/s}$ (æ³¨æ„è¿™é‡Œç”¨ cm/s è€Œé m/s)
2.  **é¢„å› å­è®¡ç®—**ï¼š
    $$ \frac{1}{\hbar c} \approx \frac{1}{4.1357 \times 10^{-15} \times 3.0 \times 10^{10}} \approx \frac{1}{1.24 \times 10^{-4}} \approx 8065.5 \text{ cm}^{-1}/\text{eV} $$
    
    æˆ–è€…ä½¿ç”¨æ›´ç²¾ç¡®çš„æ¨å¯¼é€»è¾‘ï¼ˆå¦‚æœ¬æ•™ç¨‹æ¡ˆä¾‹è„šæœ¬æ‰€ç¤ºï¼‰ï¼š
    $$ \text{ç³»æ•°} = \frac{1}{c_{\text{SI}}} \times \frac{1}{\hbar_{\text{SI}}} \dots $$
    
    åœ¨ Python è„šæœ¬ä¸­ï¼Œä¸ºäº†ä¿æŒç‰©ç†æ¸…æ™°ï¼Œå»ºè®®ä¿ç•™å®Œæ•´çš„å¸¸æ•°é¡¹ï¼š
    ```python
    # ç¤ºä¾‹é€»è¾‘
    omega_in_inverse_seconds = energy_in_eV / (4.1357e-15) # E = h_bar * omega
    c_in_cm_per_s = 3.0e10
    prefactor = omega_in_inverse_seconds / c_in_cm_per_s
    # æœ€ç»ˆ alpha å•ä½ä¸º cm^-1
    ```

ç†è§£äº†è¿™äº›åŸç†åï¼Œä¸‹ä¸€ç« æˆ‘ä»¬å°†è¿›å…¥å®æˆ˜ç¯èŠ‚ï¼Œå¯¹ $\text{SiO}_2$ ä½“ç³»è¿›è¡Œå®Œæ•´çš„è®¡ç®—æ“ä½œã€‚

# ç¬¬äºŒç« ï¼šç”µå­ç»“æ„è®¡ç®—ä¸çŸ©é˜µç”Ÿæˆ (ABACUS)

åœ¨ç¬¬ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†çº¿æ€§å…‰å­¦æ€§è´¨è®¡ç®—çš„åŸºæœ¬ç‰©ç†å›¾åƒã€‚ä»æœ¬ç« å¼€å§‹ï¼Œæˆ‘ä»¬å°†è¿›å…¥å®æˆ˜ç¯èŠ‚ã€‚

è®¡ç®—ææ–™çš„å…‰å­¦æ€§è´¨ï¼ˆå¦‚ä»‹ç”µå‡½æ•°ã€å¸æ”¶ç³»æ•°ï¼‰æ˜¯ä¸€ä¸ªå…¸å‹çš„**ä¸¤æ­¥èµ°**æµç¨‹ï¼š
1.  **ç¬¬ä¸€æ­¥ï¼ˆABACUSï¼‰**ï¼šè¿›è¡ŒåŸºæ€ SCF è®¡ç®—ã€‚è¿™ä¸€æ­¥ä¸ä»…ä»…æ˜¯ä¸ºäº†å¾—åˆ°èƒ½é‡ï¼Œæ›´æ ¸å¿ƒçš„ç›®æ ‡æ˜¯**â€œç”Ÿäº§æ•°æ®â€**â€”â€”å³ç”Ÿæˆæè¿°ç”µå­ä½“ç³»çš„å“ˆå¯†é¡¿é‡çŸ©é˜µï¼ˆHamiltonianï¼‰ã€é‡å çŸ©é˜µï¼ˆOverlapï¼‰å’Œä½ç½®ç®—ç¬¦çŸ©é˜µï¼ˆPosition Matrixï¼‰ã€‚
2.  **ç¬¬äºŒæ­¥ï¼ˆpyatbï¼‰**ï¼šè¯»å–ä¸Šè¿°çŸ©é˜µï¼Œåˆ©ç”¨ Kubo-Greenwood å…¬å¼è¿›è¡Œåå¤„ç†ï¼Œè®¡ç®—å…‰å­¦ç”µå¯¼ç‡å’Œä»‹ç”µå‡½æ•°ã€‚

æœ¬ç« å°†èšç„¦äº**ç¬¬ä¸€æ­¥**ã€‚æˆ‘ä»¬å°†ä»¥æ™¶æ€äºŒæ°§åŒ–ç¡… ($\text{SiO}_2$) ä¸ºä¾‹ï¼Œè¯¦ç»†è®²è§£å¦‚ä½•é…ç½® ABACUS çš„ `INPUT` æ–‡ä»¶ä»¥æ­£ç¡®è¾“å‡ºç¨€ç–çŸ©é˜µï¼Œå¹¶æ•™ä¼šä½ å¦‚ä½•ä»è¾“å‡ºæ—¥å¿—ä¸­æå–è¿æ¥ä¸¤æ­¥è®¡ç®—çš„å…³é”®â€œæ¡¥æ¢â€å‚æ•°ã€‚

---

## 2.1 è¾“å…¥æ–‡ä»¶å‡†å¤‡ä¸å…³é”®å‚æ•°è®¾ç½®

è¦ä½¿ç”¨ pyatb è¿›è¡Œåå¤„ç†ï¼ŒABACUS çš„è®¡ç®—å¿…é¡»åŸºäº **LCAOï¼ˆçº¿æ€§ç»„åˆåŸå­è½¨é“ï¼‰** åŸºç»„ã€‚å¹³é¢æ³¢ï¼ˆPlane Waveï¼‰æ¨¡å¼ä¸‹çš„æ³¢å‡½æ•°æ— æ³•ç›´æ¥è¢« pyatb è¯»å–ã€‚

### 2.1.1 æ–‡ä»¶ç»“æ„å‡†å¤‡
å»ºè®®ä¸ºæ¯ä¸ªæ¡ˆä¾‹å»ºç«‹æ¸…æ™°çš„æ–‡ä»¶å¤¹ç»“æ„ã€‚å¯¹äº $\text{SiO}_2$ï¼Œæˆ‘ä»¬éœ€è¦å‡†å¤‡ä»¥ä¸‹æ ¸å¿ƒæ–‡ä»¶ï¼š

```text
work_dir/
â”œâ”€â”€ INPUT               # æ§åˆ¶å‚æ•°
â”œâ”€â”€ STRU                # æ™¶ä½“ç»“æ„ (SiO2)
â”œâ”€â”€ KPT                 # Kç‚¹è®¾ç½®
â”œâ”€â”€ Si_ONCV_PBE-1.0.upf # Si èµåŠ¿
â”œâ”€â”€ O_ONCV_PBE-1.0.upf  # O èµåŠ¿
â”œâ”€â”€ Si_gga_7au_100Ry_2s2p1d.orb # Si è½¨é“æ–‡ä»¶
â””â”€â”€ O_gga_7au_100Ry_2s2p1d.orb  # O è½¨é“æ–‡ä»¶
```

### 2.1.2 æ„å»º INPUT æ–‡ä»¶ (æ ¸å¿ƒ)

è¿™æ˜¯æœ¬ç« çš„é‡ä¸­ä¹‹é‡ã€‚ä¸ºäº†è®© ABACUS è¾“å‡º pyatb æ‰€éœ€çš„ `.csr` (Compressed Sparse Row) æ ¼å¼çŸ©é˜µæ–‡ä»¶ï¼Œå¿…é¡»æ˜¾å¼å¼€å¯ç‰¹å®šçš„è¾“å‡ºå¼€å…³ã€‚

ä»¥ä¸‹æ˜¯é’ˆå¯¹ $\text{SiO}_2$ å…‰å­¦æ€§è´¨è®¡ç®—çš„æ¨è `INPUT` æ–‡ä»¶è®¾ç½®ï¼š

```bash
INPUT_PARAMETERS
# 1. åŸºç¡€è®¡ç®—æ§åˆ¶
suffix              silica      # è¾“å‡ºæ–‡ä»¶å¤¹åç§°ï¼Œå¦‚ OUT.silica
calculation         scf         # è‡ªæ´½åœºè®¡ç®—
esolver_type        ksdft       # Kohn-Sham DFT
basis_type          lcao        # ã€å…³é”®ã€‘å¿…é¡»ä½¿ç”¨ LCAO åŸºç»„
symmetry            0           # å…³é—­å¯¹ç§°æ€§ï¼ˆæ¨èï¼‰ï¼Œé¿å…çŸ©é˜µè¾“å‡ºæ—¶çš„æ—‹è½¬é—®é¢˜
ks_solver           genelpa     # æ±‚è§£å™¨ï¼Œgenelpa æ•ˆç‡è¾ƒé«˜

# 2. ç”µå­ç»“æ„ä¸æ”¶æ•›å‚æ•°
ecutwfc             100         # èƒ½é‡æˆªæ–­ (Ry)ï¼Œéœ€æ ¹æ®èµåŠ¿å’Œè½¨é“ç²¾åº¦æµ‹è¯•
scf_thr             1e-8        # è‡ªæ´½æ”¶æ•›ç²¾åº¦ (Ry)ï¼Œå…‰å­¦è®¡ç®—å»ºè®®é«˜ç²¾åº¦
smearing_method     gaussian    # å±•å®½æ–¹æ³•
smearing_sigma      0.01        # å±•å®½å®½åº¦ (Ry)
mixing_type         broyden     # ç”µè·å¯†åº¦æ··åˆæ–¹æ³•
mixing_beta         0.1         # æ··åˆå‚æ•°

# 3. çŸ©é˜µè¾“å‡ºæ§åˆ¶ (Pyatb æ¥å£æ ¸å¿ƒ)
out_chg             1           # è¾“å‡ºç”µè·å¯†åº¦ (å»ºè®®å¼€å¯)
out_mat_hs2         1           # ã€å…³é”®ã€‘è¾“å‡ºäºŒä¸­å¿ƒå“ˆå¯†é¡¿é‡(H)å’Œé‡å çŸ©é˜µ(S)
out_mat_r           1           # ã€å…³é”®ã€‘è¾“å‡ºä½ç½®ç®—ç¬¦/å¶æçŸ©é˜µ(r)

# 4. èµåŠ¿ä¸è½¨é“è·¯å¾„
pseudo_dir          ./
orbital_dir         ./
```

#### ğŸ’¡ ä¸“å®¶è§£è¯»ï¼šä¸ºä»€ä¹ˆéœ€è¦è¿™äº›å‚æ•°ï¼Ÿ

*   **`basis_type lcao`**: pyatb çš„æ ¸å¿ƒç®—æ³•åŸºäºç´§æŸç¼šæ¨¡å‹ï¼ˆTight-Bindingï¼‰ï¼Œä¾èµ–äºåŸå­è½¨é“åŸºç»„ä¸‹çš„çŸ©é˜µå…ƒã€‚
*   **`out_mat_hs2 1`**: é»˜è®¤æƒ…å†µä¸‹ ABACUS ä¸è¾“å‡ºç¨€ç–çŸ©é˜µã€‚å¼€å¯æ­¤é¡¹åï¼Œè½¯ä»¶ä¼šå°†å®ç©ºé—´ä¸­çš„ $H_{\mu\nu}(\mathbf{R})$ å’Œ $S_{\mu\nu}(\mathbf{R})$ å†™å…¥ç£ç›˜ã€‚è¿™æ˜¯è®¡ç®—èƒ½å¸¦ç»“æ„çš„åŸºç¡€ã€‚
*   **`out_mat_r 1`**: è¿™æ˜¯**å…‰å­¦æ€§è´¨è®¡ç®—çš„çµé­‚**ã€‚æ ¹æ® Kubo-Greenwood å…¬å¼ï¼Œå…‰ç”µå¯¼ç‡å–å†³äºé€Ÿåº¦çŸ©é˜µå…ƒ $\langle \psi_{n\mathbf{k}} | \mathbf{v} | \psi_{m\mathbf{k}} \rangle$ã€‚åœ¨ LCAO è¡¨è±¡ä¸‹ï¼Œè¿™éœ€è¦é€šè¿‡ä½ç½®ç®—ç¬¦çŸ©é˜µ $\langle \phi_\mu | \mathbf{r} | \phi_\nu \rangle$ è½¬æ¢å¾—åˆ°ã€‚**å¦‚æœå¿˜è®°å¼€å¯æ­¤é¡¹ï¼Œåç»­ pyatb å°†å› ç¼ºå°‘å¶æçŸ©é˜µè€Œæ— æ³•è®¡ç®—ä»‹ç”µå‡½æ•°ã€‚**

### 2.1.3 STRU ä¸ KPT æ–‡ä»¶ç®€è¿°
*   **STRU**: åŒ…å«æ™¶æ ¼å¸¸æ•°ã€æ™¶æ ¼çŸ¢é‡ã€åŸå­è´¨é‡ã€èµåŠ¿/è½¨é“æ–‡ä»¶ååŠåŸå­åæ ‡ã€‚è¯·ç¡®ä¿åæ ‡å•ä½ä¸ `LATTICE_CONSTANT` ä¸€è‡´ã€‚
*   **KPT**: SCF è®¡ç®—çš„ K ç‚¹å¯†åº¦ã€‚ä¾‹å¦‚ `6 6 6 0 0 0`ã€‚
    *   *æ³¨æ„*ï¼šè¿™é‡Œ K ç‚¹ä¸»è¦ç”¨äºæ”¶æ•›åŸºæ€ç”µè·å¯†åº¦ã€‚pyatb åå¤„ç†æ—¶ä¼šä½¿ç”¨æ›´å¯†çš„ K ç‚¹ç½‘æ ¼ï¼ˆåœ¨ pyatb çš„è¾“å…¥ä¸­å®šä¹‰ï¼‰ï¼Œä½†åŸºæ€æ³¢å‡½æ•°çš„è´¨é‡å–å†³äºè¿™ä¸€æ­¥çš„ K ç‚¹è®¾ç½®ã€‚

---

## 2.2 è¿è¡Œ SCF ä¸å…³é”®ä¿¡æ¯æå–

é…ç½®å¥½æ–‡ä»¶åï¼Œå³å¯è¿è¡Œ ABACUSã€‚

### 2.2.1 æäº¤ä»»åŠ¡
ä½¿ç”¨ MPI å¹¶è¡Œè¿è¡Œï¼ˆå‡è®¾ä½¿ç”¨ 16 æ ¸ï¼‰ï¼š
```bash
export OMP_NUM_THREADS=1
mpirun -np 16 abacus
```

### 2.2.2 éªŒè¯è¾“å‡ºçŸ©é˜µ
è®¡ç®—å®Œæˆåï¼Œé¦–å…ˆæ£€æŸ¥è¾“å‡ºç›®å½•ï¼ˆä¾‹å¦‚ `OUT.silica/`ï¼‰ä¸‹æ˜¯å¦ç”Ÿæˆäº†ä»¥ä¸‹å…³é”®æ–‡ä»¶ï¼š

1.  **`data-HR-sparse_SPIN0.csr`**: å®ç©ºé—´å“ˆå¯†é¡¿é‡çŸ©é˜µï¼ˆç¨€ç–æ ¼å¼ï¼‰ã€‚
2.  **`data-SR-sparse_SPIN0.csr`**: å®ç©ºé—´é‡å çŸ©é˜µã€‚
3.  **`data-rR-sparse.csr`**: ä½ç½®ç®—ç¬¦çŸ©é˜µã€‚

> **é£é™©æç¤º**ï¼šå¦‚æœç¼ºå°‘ `data-rR-sparse.csr`ï¼Œè¯·æ£€æŸ¥ `INPUT` ä¸­æ˜¯å¦è®¾ç½®äº† `out_mat_r 1`ã€‚å¦‚æœç¼ºå°‘ `HR` æˆ– `SR` æ–‡ä»¶ï¼Œæ£€æŸ¥ `out_mat_hs2 1`ã€‚

### 2.2.3 æå–â€œæ¡¥æ¢â€å‚æ•° (Critical Step)

åœ¨è¿›å…¥ä¸‹ä¸€ç« ä½¿ç”¨ pyatb ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ä» ABACUS çš„æ—¥å¿—æ–‡ä»¶ï¼ˆ`running_scf.log` æˆ–æ ‡å‡†è¾“å‡ºï¼‰ä¸­æ‰‹åŠ¨æå–ä¸¤ä¸ªè‡³å…³é‡è¦çš„ç‰©ç†é‡ã€‚**pyatb æ— æ³•è‡ªåŠ¨è¯»å–è¿™äº›å€¼ï¼Œå¿…é¡»ç”±ç”¨æˆ·å¡«å…¥å…¶è¾“å…¥æ–‡ä»¶ã€‚**

æˆ‘ä»¬éœ€è¦æå–ï¼š
1.  **Fermi Energy ($E_F$)**: è´¹ç±³èƒ½çº§ã€‚
2.  **Occupied Bands**: å æ®èƒ½å¸¦çš„æ•°ç›®ï¼ˆå³ä»·å¸¦æ•°ï¼‰ã€‚

#### æ“ä½œæŒ‡å—
è¿›å…¥è¾“å‡ºç›®å½•ï¼Œä½¿ç”¨ `grep` å‘½ä»¤æŸ¥æ‰¾ï¼š

```bash
# è¿›å…¥è¾“å‡ºç›®å½•
cd OUT.silica

# 1. æŸ¥æ‰¾å æ®å¸¦æ•° (Occupied bands)
grep "occupied bands" running_scf.log
# è¾“å‡ºç¤ºä¾‹: occupied bands = 64

# 2. æŸ¥æ‰¾è´¹ç±³èƒ½çº§ (Fermi Energy)
grep "E_Fermi" running_scf.log | tail -n 1
# è¾“å‡ºç¤ºä¾‹: E_Fermi        0.4070749075         5.5385382545
```

#### æ•°æ®è§£è¯»ä¸è®°å½•
*   **Occupied Bands**: ç¤ºä¾‹ä¸­ä¸º `64`ã€‚è¯·è®°å½•æ­¤æ•°å€¼ã€‚
*   **E_Fermi**: ABACUS é€šå¸¸è¾“å‡ºä¸¤åˆ—æ•°å€¼ã€‚
    *   ç¬¬ä¸€åˆ—å•ä½é€šå¸¸ä¸º **Rydberg (Ry)**ã€‚
    *   ç¬¬äºŒåˆ—å•ä½é€šå¸¸ä¸º **eV**ã€‚
    *   *å®æˆ˜å»ºè®®*ï¼šè®°å½• **eV** å•ä½çš„æ•°å€¼ï¼ˆä¾‹å¦‚ `5.5385382545`ï¼‰ï¼Œå› ä¸º pyatb é»˜è®¤æ”¯æŒ eV è¾“å…¥ï¼Œè¿™æ ·æ›´ç¬¦åˆç›´è§‰ã€‚

### 2.2.4 å‡†å¤‡ pyatb æ‰€éœ€çš„æ™¶æ ¼ä¿¡æ¯

é™¤äº†ä¸Šè¿°ç”µå­å‚æ•°ï¼Œpyatb çš„ `Input` æ–‡ä»¶è¿˜éœ€è¦æ‰‹åŠ¨å¡«å†™æ™¶æ ¼å¸¸æ•°å’Œæ™¶æ ¼çŸ¢é‡ã€‚**pyatb ç›®å‰ä¸ä¼šè‡ªåŠ¨ä» `.csr` æ–‡ä»¶ä¸­è§£ææ™¶æ ¼ä¿¡æ¯ã€‚**

è¯·æ‰“å¼€ä½ çš„ `STRU` æ–‡ä»¶æˆ–æŸ¥çœ‹ `running_scf.log` å¼€å¤´çš„ `Lattice vectors` éƒ¨åˆ†ï¼Œè®°å½•ä¸‹ï¼š
1.  **Lattice Constant**: æ™¶æ ¼å¸¸æ•°ï¼ˆBohrï¼‰ã€‚
2.  **Lattice Vectors**: ä¸‰ä¸ªæ™¶æ ¼çŸ¢é‡ï¼ˆé€šå¸¸æ˜¯å½’ä¸€åŒ–çš„æˆ–ä»¥æ™¶æ ¼å¸¸æ•°ä¸ºå•ä½çš„ï¼‰ã€‚

---

## æœ¬ç« å°ç»“

è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†â€œæ•°æ®ç”Ÿäº§â€é˜¶æ®µã€‚ä½ ç°åœ¨åº”è¯¥æ‰‹æ¡ä»¥ä¸‹â€œåŸæ–™â€ï¼š
1.  **ä¸‰ä¸ªç¨€ç–çŸ©é˜µæ–‡ä»¶** (`HR`, `SR`, `rR`) â€”â€” ä½äº `OUT.silica/` ç›®å½•ä¸‹ã€‚
2.  **ä¸¤ä¸ªå…³é”®å‚æ•°** ($E_F \approx 5.5385 \text{ eV}$, $N_{occ} = 64$) â€”â€” è®°å½•åœ¨æ¡ˆã€‚
3.  **æ™¶æ ¼å‡ ä½•ä¿¡æ¯** â€”â€” æ¥æºäº `STRU`ã€‚

åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ‰®æ¼”â€œå·¥åŒ â€çš„è§’è‰²ï¼Œåˆ©ç”¨ pyatb å°†è¿™äº›åŸæ–™åŠ å·¥æˆç²¾ç¾çš„å…‰å­¦æ€§è´¨å›¾è°±ã€‚è¯·åŠ¡å¿…ä¿å­˜å¥½ä¸Šè¿°æ–‡ä»¶ï¼Œä¸è¦åˆ é™¤ `OUT.silica` ç›®å½•ã€‚

# ç¬¬ä¸‰ç« ï¼šä»‹ç”µå‡½æ•°è®¡ç®— (pyatb)

åœ¨ä¸Šä¸€ç« ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ ABACUS å®Œæˆäº†è‡ªæ´½è®¡ç®—ï¼ˆSCFï¼‰ï¼Œå¹¶æˆåŠŸè¾“å‡ºäº†æ„å»ºç´§æŸç¼šæ¨¡å‹æ‰€éœ€çš„ç¨€ç–çŸ©é˜µæ–‡ä»¶ï¼ˆ`data-HR-sparse_*.csr`, `data-SR-sparse_*.csr`, `data-rR-sparse.csr`ï¼‰ã€‚

æœ¬ç« å°†è¿›å…¥**ä¸¤æ­¥èµ°**æµç¨‹çš„ç¬¬äºŒæ­¥ï¼šä½¿ç”¨ **pyatb** è¯»å–è¿™äº›çŸ©é˜µï¼Œè®¡ç®—ä»‹ç”µå‡½æ•°çš„è™šéƒ¨ï¼ˆ$\epsilon_2$ï¼‰ï¼Œå¹¶é€šè¿‡ Kramers-Kronig å˜æ¢å¾—åˆ°å®éƒ¨ï¼ˆ$\epsilon_1$ï¼‰ã€‚è¿™æ˜¯è¿æ¥å¾®è§‚ç”µå­ç»“æ„ä¸å®è§‚å…‰å­¦æ€§è´¨çš„å…³é”®æ¡¥æ¢ã€‚

> **âš ï¸ æ ¸å¿ƒæç¤º**ï¼špyatb æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„åå¤„ç†ç¨‹åºã€‚å®ƒä¸è¿›è¡Œä»å¤´ç®—ï¼ˆab initioï¼‰æ±‚è§£ï¼Œè€Œæ˜¯åŸºäº ABACUS äº§ç”Ÿçš„å“ˆå¯†é¡¿é‡å’Œå¶æçŸ©é˜µè¿›è¡Œçº¿æ€§å“åº”è®¡ç®—ã€‚å› æ­¤ï¼Œ**å‚æ•°çš„ä¸€è‡´æ€§**ï¼ˆç‰¹åˆ«æ˜¯è´¹ç±³èƒ½çº§å’Œæ™¶æ ¼å¸¸æ•°ï¼‰è‡³å…³é‡è¦ã€‚

---

## 3.1 ç›®å½•ç»“æ„ä¸æ•°æ®è¿ç§»

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å»ºç«‹ä¸€ä¸ªç‹¬ç«‹çš„å·¥ä½œç›®å½•æ¥è¿›è¡Œå…‰å­¦æ€§è´¨è®¡ç®—ï¼Œä»¥ä¿æŒæ–‡ä»¶æ¡ç†æ¸…æ™°ã€‚

### 3.1.1 å»ºç«‹å·¥ä½œç›®å½•
å‡è®¾ä½ çš„ ABACUS è®¡ç®—ç›®å½•ä¸º `silica_PrimaryCell`ï¼Œä¸”è¾“å‡ºæ–‡ä»¶ä½äº `OUT.silica` ä¸­ã€‚æˆ‘ä»¬åœ¨åŒçº§ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º `pyatb_OpticConductivity` çš„æ–‡ä»¶å¤¹ã€‚

```bash
# åœ¨ silica_PrimaryCell ç›®å½•ä¸‹
mkdir pyatb_OpticConductivity
cd pyatb_OpticConductivity
```

### 3.1.2 é“¾æ¥æˆ–å¤åˆ¶å…³é”®çŸ©é˜µæ–‡ä»¶
pyatb è¿è¡Œå¿…é¡»ä¾èµ– ABACUS ç”Ÿæˆçš„ä¸‰ä¸ªæ ¸å¿ƒçŸ©é˜µæ–‡ä»¶ã€‚è¯·æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å°†å®ƒä»¬å¤åˆ¶åˆ°å½“å‰ç›®å½•ï¼š

```bash
# å¤åˆ¶å“ˆå¯†é¡¿é‡çŸ©é˜µ (HR)
cp ../OUT.silica/data-HR-sparse_SPIN0.csr .

# å¤åˆ¶é‡å çŸ©é˜µ (SR)
cp ../OUT.silica/data-SR-sparse_SPIN0.csr .

# å¤åˆ¶ä½ç½®ç®—ç¬¦å¶æçŸ©é˜µ (rR)
cp ../OUT.silica/data-rR-sparse.csr .
```

> **é£é™©æç¤º**ï¼šå¦‚æœä½ çš„ `OUT.silica` ç›®å½•ä¸‹æ²¡æœ‰è¿™äº›æ–‡ä»¶ï¼Œè¯´æ˜ä½ åœ¨ä¸Šä¸€ç« çš„ `INPUT` æ–‡ä»¶ä¸­æœªæ­£ç¡®è®¾ç½® `out_mat_hs2` å’Œ `out_mat_r` ä¸º `1`ã€‚è¯·è¿”å›ä¸Šä¸€ç« é‡æ–°è¿è¡Œ ABACUS è®¡ç®—ã€‚

---

## 3.2 pyatb è¾“å…¥æ–‡ä»¶ç¼–å†™

è¿™æ˜¯æœ¬ç« æœ€å®¹æ˜“å‡ºé”™çš„ç¯èŠ‚ã€‚æˆ‘ä»¬éœ€è¦ç¼–å†™ pyatb çš„é…ç½®æ–‡ä»¶ `Input`ï¼ˆæ³¨æ„é¦–å­—æ¯å¤§å†™ï¼‰ã€‚è¯¥æ–‡ä»¶åŒ…å«ä¸‰ä¸ªä¸»è¦éƒ¨åˆ†ï¼šå‚æ•°è®¾ç½®ã€æ™¶æ ¼ä¿¡æ¯å’ŒåŠŸèƒ½æ¨¡å—ã€‚

### 3.2.1 å…³é”®å‚æ•°æå– (Pre-flight Check)
åœ¨ç¼–å†™ `Input` ä¹‹å‰ï¼Œå¿…é¡»ä» ABACUS çš„æ—¥å¿—æ–‡ä»¶ `running_scf.log` ä¸­æå–ä¸¤ä¸ªå…³é”®æ•°å€¼ï¼š**è´¹ç±³èƒ½çº§ (E_Fermi)** å’Œ **å æ®å¸¦æ•° (occupied bands)**ã€‚

è¯·åœ¨ç»ˆç«¯è¿è¡Œä»¥ä¸‹å‘½ä»¤è¿›è¡ŒæŸ¥è¯¢ï¼š

```bash
# æŸ¥è¯¢å æ®å¸¦æ•°
grep 'occupied bands' ../OUT.silica/running_scf.log
# è¾“å‡ºç¤ºä¾‹: occupied bands = 64

# æŸ¥è¯¢è´¹ç±³èƒ½çº§ (å–æœ€åä¸€æ­¥è¿­ä»£çš„å€¼)
grep 'E_Fermi' ../OUT.silica/running_scf.log | tail -n 1
# è¾“å‡ºç¤ºä¾‹: E_Fermi                0.4070749075         5.5385382545
```
*æ³¨æ„ï¼šABACUS è¾“å‡ºçš„è´¹ç±³èƒ½çº§é€šå¸¸æœ‰ä¸¤åˆ—ï¼Œç¬¬äºŒåˆ—å•ä½ä¸º eVã€‚è¯·è®°å½•ä¸‹ **5.5385382545** (eV) å’Œ **64** (bands)ã€‚*

### 3.2.2 ç¼–å†™ Input æ–‡ä»¶
æ–°å»ºåä¸º `Input` çš„æ–‡ä»¶ï¼Œå¡«å…¥ä»¥ä¸‹å†…å®¹ã€‚è¯·åŠ¡å¿…æ ¹æ®ä¸Šä¸€æ­¥æå–çš„æ•°å€¼ä¿®æ”¹ `fermi_energy` å’Œ `occ_band`ã€‚

```plaintext
INPUT_PARAMETERS
{
    # åŸºç¡€å‚æ•°
    nspin           1
    package         ABACUS
    
    # --- å…³é”®å‚æ•°ï¼šå¿…é¡»ä¸ SCF ç»“æœä¸¥æ ¼ä¸€è‡´ ---
    fermi_energy    5.5385382545   # å¡«å…¥ grep å¾—åˆ°çš„ eV æ•°å€¼
    fermi_energy_unit eV
    # -------------------------------------

    # çŸ©é˜µæ–‡ä»¶è·¯å¾„
    HR_route        data-HR-sparse_SPIN0.csr
    SR_route        data-SR-sparse_SPIN0.csr
    rR_route        data-rR-sparse.csr
    
    # çŸ©é˜µå•ä½ (ABACUS é»˜è®¤è¾“å‡ºå•ä½)
    HR_unit         Ry
    rR_unit         Bohr
}

LATTICE
{
    # âš ï¸ é£é™©æç¤ºï¼špyatb ä¸ä¼šè‡ªåŠ¨è¯»å– STRUï¼Œå¿…é¡»æ‰‹åŠ¨å¡«å†™
    # è¿™é‡Œçš„æ•°æ®æ¥è‡ª ABACUS çš„ STRU æ–‡ä»¶æˆ– running_scf.log
    lattice_constant 1.8897261246257702
    lattice_constant_unit Bohr
    lattice_vector
    7.1199998856 0.0 0.0 
    0.0 7.1199998856 0.0 
    0.0 0.0 7.1199998856 
}

OPTICAL_CONDUCTIVITY
{
    # --- å…³é”®å‚æ•°ï¼šå¿…é¡»ä¸ SCF ç»“æœä¸¥æ ¼ä¸€è‡´ ---
    occ_band        64             # å¡«å…¥ grep å¾—åˆ°çš„ occupied bands
    # -------------------------------------

    # å…‰è°±èƒ½é‡èŒƒå›´ (eV)
    omega           0 30           # è®¡ç®— 0 åˆ° 30 eV çš„å…‰è°±
    domega          0.01           # èƒ½é‡æ­¥é•¿
    
    # å±•å®½å› å­ (Broadening)
    eta             0.1            # æ´›ä¼¦å…¹å±•å®½ï¼Œæ¨¡æ‹Ÿæœ‰é™å¯¿å‘½æ•ˆåº”
    
    # K ç‚¹ç½‘æ ¼
    # å»ºè®®æ¯” SCF è®¡ç®—çš„ç½‘æ ¼æ›´å¯†ï¼Œä»¥è·å¾—å¹³æ»‘çš„å…‰è°±
    grid            20 20 20       
}
```

**å‚æ•°è¯¦è§£**ï¼š
*   `eta (0.1)`: è¿™æ˜¯ä¸€ä¸ªå”¯è±¡å‚æ•°ï¼ˆphenomenological parameterï¼‰ï¼Œç”¨äºé¿å…åˆ†æ¯ä¸ºé›¶å¹¶å‘æ•£ï¼ŒåŒæ—¶ä¹Ÿæ¨¡æ‹Ÿäº†ç”µå­çš„æœ‰é™å¯¿å‘½ã€‚å€¼è¶Šå°ï¼Œå…‰è°±å³°è¶Šå°–é”ï¼›å€¼è¶Šå¤§ï¼Œå…‰è°±è¶Šå¹³æ»‘ä½†ç‰¹å¾å¯èƒ½æ¨¡ç³Šã€‚
*   `grid`: çº¿æ€§å…‰å­¦æ€§è´¨è®¡ç®—é€šå¸¸éœ€è¦æ¯” SCF æ›´å¯†çš„ K ç‚¹ç½‘æ ¼æ‰èƒ½æ”¶æ•›ã€‚

---

## 3.3 è¿è¡Œè®¡ç®—ä¸åŸå§‹æ•°æ®è§£æ

### 3.3.1 æäº¤ä»»åŠ¡
é…ç½®å®Œæˆåï¼Œä½¿ç”¨ MPI å¹¶è¡Œè¿è¡Œ pyatbã€‚

```bash
# æ¨èä½¿ç”¨ä¸ ABACUS ç›¸åŒçš„æ ¸æ•°ï¼Œä¾‹å¦‚ 16 æ ¸
export OMP_NUM_THREADS=1 
mpirun -np 16 pyatb
```

è®¡ç®—è¿‡ç¨‹é€šå¸¸æ²¡æœ‰å±å¹•è¾“å‡ºï¼Œè¯·æŸ¥çœ‹ç”Ÿæˆçš„ `Out/` ç›®å½•ã€‚

### 3.3.2 ç›‘æ§è¿è¡Œ
å¯ä»¥é€šè¿‡æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ç¡®è®¤è¿›åº¦ï¼š
```bash
tail -f Out/running.log
```
å½“çœ‹åˆ° `Finish Time` å­—æ ·æ—¶ï¼Œè¡¨ç¤ºè®¡ç®—ç»“æŸã€‚

### 3.3.3 è¾“å‡ºæ–‡ä»¶è§£æ
è®¡ç®—å®Œæˆåï¼Œè¿›å…¥ `Out/Optical_Conductivity` ç›®å½•ï¼Œä½ ä¼šçœ‹åˆ°ä»¥ä¸‹æ ¸å¿ƒæ–‡ä»¶ï¼š

1.  **`dielectric_function_imag_part.dat`**: ä»‹ç”µå‡½æ•°è™šéƒ¨ $\epsilon_2(\omega)$ã€‚è¿™æ˜¯ pyatb ç›´æ¥è®¡ç®—çš„ç‰©ç†é‡ï¼Œåæ˜ äº†ææ–™çš„**å…‰å¸æ”¶**ç‰¹æ€§ã€‚
2.  **`dielectric_function_real_part.dat`**: ä»‹ç”µå‡½æ•°å®éƒ¨ $\epsilon_1(\omega)$ã€‚è¿™æ˜¯é€šè¿‡ Kramers-Kronig å…³ç³»ä»è™šéƒ¨æ¨å¯¼å‡ºæ¥çš„ï¼Œåæ˜ äº†ææ–™çš„**æŠ˜å°„**ç‰¹æ€§ã€‚

æ–‡ä»¶æ ¼å¼å¦‚ä¸‹ï¼ˆä»¥è™šéƒ¨ä¸ºä¾‹ï¼‰ï¼š
```text
# omega(eV)      xx           xy           xz           ...
   0.00000   0.000000e+00 0.000000e+00 ...
   0.01000   9.564624e-06 -6.324391e-15 ...
```
*   **ç¬¬ 1 åˆ—**: å…‰å­èƒ½é‡ $\hbar\omega$ (eV)ã€‚
*   **ç¬¬ 2-10 åˆ—**: ä»‹ç”µå¼ é‡çš„å„ä¸ªåˆ†é‡ ($\epsilon_{xx}, \epsilon_{xy}, \dots$)ã€‚å¯¹äºå„å‘åŒæ€§ææ–™æˆ–ç«‹æ–¹æ™¶ç³»ï¼ˆå¦‚æœ¬ä¾‹ä¸­çš„ $\beta$-Cristobaliteï¼‰ï¼Œé€šå¸¸å…³æ³¨ $xx, yy, zz$ åˆ†é‡çš„å¹³å‡å€¼ã€‚

---

## 3.4 åå¤„ç†ï¼šè®¡ç®—å¸æ”¶ç³»æ•°ä¸æŠ˜å°„ç‡

å¾—åˆ° $\epsilon_1(\omega)$ å’Œ $\epsilon_2(\omega)$ åï¼Œæˆ‘ä»¬å¯ä»¥æ¨å¯¼å‡ºæ‰€æœ‰å…¶ä»–çº¿æ€§å…‰å­¦æ€§è´¨ã€‚

### 3.4.1 ç‰©ç†åŸç†ä¸å•ä½æ¢ç®—
å®éªŒä¸Šå¸¸ç”¨çš„**å¸æ”¶ç³»æ•° (Absorption Coefficient, $\alpha$)** å•ä½æ˜¯ $\text{cm}^{-1}$ã€‚ä½†è®¡ç®—è¾“å‡ºæ˜¯åŸå­å•ä½æˆ– eVã€‚æˆ‘ä»¬éœ€è¦è¿›è¡Œä¸¥æ ¼çš„å•ä½æ¢ç®—ã€‚

å…¬å¼å¦‚ä¸‹ï¼š
$$ \alpha(\omega) = \frac{2\omega}{c} \kappa(\omega) = \frac{\omega}{c} \sqrt{2\left(\sqrt{\epsilon_1^2 + \epsilon_2^2} - \epsilon_1\right)} $$

**å•ä½æ¢ç®—é€»è¾‘**ï¼š
1.  **èƒ½é‡è½¬é¢‘ç‡**: $\omega [\text{s}^{-1}] = E [\text{eV}] / \hbar [\text{eV}\cdot\text{s}]$
    *   $\hbar \approx 4.1357 \times 10^{-15} \text{ eV}\cdot\text{s}$
    *   æ¢ç®—å› å­ $C_{\omega} \approx 2.418 \times 10^{14} \text{ s}^{-1}/\text{eV}$
2.  **å…‰é€Ÿ**: ä¸ºåŒ¹é… $\text{cm}^{-1}$ï¼Œå…‰é€Ÿå– $c \approx 3.0 \times 10^{10} \text{ cm/s}$ã€‚

### 3.4.2 Python åå¤„ç†è„šæœ¬
åˆ›å»ºä¸€ä¸ª Python è„šæœ¬ `plot_optics.py`ï¼Œå®Œæˆæ•°æ®è¯»å–ã€ç‰©ç†é‡è®¡ç®—å’Œç»˜å›¾ã€‚

```python
import numpy as np
import matplotlib.pyplot as plt

# 1. è¯»å–æ•°æ®å‡½æ•°
def read_dielectric(filename):
    data = np.loadtxt(filename, skiprows=1)
    energy = data[:, 0]
    # å– xx, yy, zz çš„å¹³å‡å€¼ä½œä¸ºå„å‘åŒæ€§è¿‘ä¼¼
    # xxåœ¨ç¬¬1åˆ—(ç´¢å¼•1), yyåœ¨ç¬¬5åˆ—(ç´¢å¼•5), zzåœ¨ç¬¬9åˆ—(ç´¢å¼•9)
    # æ³¨æ„ï¼šæ–‡ä»¶åˆ—ç´¢å¼•ä»0å¼€å§‹ï¼Œ0æ˜¯energy
    val_xx = data[:, 1]
    val_yy = data[:, 5]
    val_zz = data[:, 9]
    avg_val = (val_xx + val_yy + val_zz) / 3.0
    return energy, avg_val

# 2. åŠ è½½å®éƒ¨å’Œè™šéƒ¨
file_imag = 'Out/Optical_Conductivity/dielectric_function_imag_part.dat'
file_real = 'Out/Optical_Conductivity/dielectric_function_real_part.dat'

energy, epsilon2 = read_dielectric(file_imag)
_, epsilon1 = read_dielectric(file_real)

# 3. è®¡ç®—å…‰å­¦æ€§è´¨
# æ¨¡é•¿ |epsilon|
epsilon_mod = np.sqrt(epsilon1**2 + epsilon2**2)

# æŠ˜å°„ç‡ n (Refractive Index)
n = np.sqrt((epsilon_mod + epsilon1) / 2.0)

# æ¶ˆå…‰ç³»æ•° kappa (Extinction Coefficient)
kappa = np.sqrt((epsilon_mod - epsilon1) / 2.0)

# å¸æ”¶ç³»æ•° alpha (Absorption Coefficient) å•ä½: cm^-1
# è½¬æ¢å¸¸æ•°æ¨å¯¼: 
# omega(s^-1) = energy(eV) * 2.418e14
# c(cm/s) = 3.0e10
# factor = 2 * 2.418e14 / 3.0e10 â‰ˆ 1.612e4
const_factor = 1.612e4 
alpha = const_factor * energy * kappa

# 4. ç»˜å›¾
fig, ax = plt.subplots(2, 2, figsize=(12, 10))

# ä»‹ç”µå‡½æ•°
ax[0, 0].plot(energy, epsilon1, label=r'$\epsilon_1$ (Real)', color='blue')
ax[0, 0].plot(energy, epsilon2, label=r'$\epsilon_2$ (Imag)', color='orange')
ax[0, 0].set_title("Dielectric Function")
ax[0, 0].legend()

# æŠ˜å°„ç‡
ax[0, 1].plot(energy, n, color='green')
ax[0, 1].set_title("Refractive Index (n)")

# æ¶ˆå…‰ç³»æ•°
ax[1, 0].plot(energy, kappa, color='purple')
ax[1, 0].set_title(r"Extinction Coefficient ($\kappa$)")

# å¸æ”¶ç³»æ•°
ax[1, 1].plot(energy, alpha, color='red')
ax[1, 1].set_title(r"Absorption Coefficient ($\alpha$)")
ax[1, 1].set_ylabel(r'$\alpha$ (cm$^{-1}$)')
ax[1, 1].set_yscale('log') # å¸æ”¶ç³»æ•°é€šå¸¸è·¨åº¦å¾ˆå¤§ï¼Œå»ºè®®ç”¨å¯¹æ•°åæ ‡

for a in ax.flat:
    a.set_xlabel("Energy (eV)")
    a.grid(True, linestyle='--', alpha=0.6)

plt.tight_layout()
plt.savefig("optical_properties.png", dpi=300)
print("ç»˜å›¾å®Œæˆï¼šoptical_properties.png")
```

è¿è¡Œæ­¤è„šæœ¬åï¼Œä½ å°†è·å¾—ä¸€å¼ åŒ…å«ä»‹ç”µå‡½æ•°ã€æŠ˜å°„ç‡ã€æ¶ˆå…‰ç³»æ•°å’Œå¸æ”¶ç³»æ•°çš„ç»¼åˆå›¾è¡¨ã€‚è‡³æ­¤ï¼Œä½ å·²ç»å®Œæˆäº†ä» DFT è®¡ç®—åˆ°å®è§‚å…‰å­¦æ€§è´¨é¢„æµ‹çš„å®Œæ•´æµç¨‹ã€‚

# ç¬¬å››ç« ï¼šåå¤„ç†ä¸å…‰è°±åˆ†æ

åœ¨ä¸Šä¸€ç« ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ `pyatb` å®Œæˆäº†ä»‹ç”µå‡½æ•°çš„è®¡ç®—ï¼Œå¾—åˆ°äº† `dielectric_function_real_part.dat` å’Œ `dielectric_function_imag_part.dat` ç­‰åŸå§‹æ•°æ®æ–‡ä»¶ã€‚ç„¶è€Œï¼Œè¿™äº›ä»…ä»…æ˜¯â€œä¸­é—´æ•°æ®â€ã€‚

ä½œä¸ºææ–™ç§‘å­¦å®¶ï¼Œæˆ‘ä»¬æœ€ç»ˆå…³å¿ƒçš„æ˜¯**å®éªŒå¯è§‚æµ‹**çš„ç‰©ç†é‡ï¼Œå¦‚**å¸æ”¶ç³»æ•°ï¼ˆAbsorption Coefficientï¼‰**ã€**æŠ˜å°„ç‡ï¼ˆRefractive Indexï¼‰**å’Œ**åå°„ç‡ï¼ˆReflectivityï¼‰**ã€‚æ­¤å¤–ï¼ŒåŸå§‹è¾“å‡ºé€šå¸¸åŸºäºåŸå­å•ä½æˆ– eVï¼Œè€Œå®éªŒå…‰è°±å¸¸ä½¿ç”¨ $nm$ æˆ– $cm^{-1}$ã€‚

æœ¬ç« å°†å¸¦ä½ å®Œæˆä»â€œè®¡ç®—æ•°æ®â€åˆ°â€œå®éªŒå…‰è°±â€çš„æœ€åä¸€æ­¥è·¨è¶Šã€‚æˆ‘ä»¬å°†ä½¿ç”¨ Python è¿›è¡Œå¼ é‡å¤„ç†ã€ç‰©ç†å…¬å¼æ¨å¯¼ä»¥åŠå•ä½æ¢ç®—ã€‚

---

## 4.1 æ•°æ®è¯»å–ä¸å¼ é‡å¹³å‡

ABACUS å’Œ pyatb è®¡ç®—å¾—åˆ°çš„ä»‹ç”µå‡½æ•°æ˜¯ä¸€ä¸ª $3 \times 3$ çš„å¼ é‡ï¼ˆTensorï¼‰ï¼ŒåŒ…å« $\epsilon_{xx}, \epsilon_{xy}, \dots, \epsilon_{zz}$ ç­‰åˆ†é‡ã€‚

### 4.1.1 ä¸ºä»€ä¹ˆéœ€è¦å¼ é‡å¹³å‡ï¼Ÿ
- **å•æ™¶/å„å‘å¼‚æ€§ææ–™**ï¼šéœ€è¦åˆ†åˆ«åˆ†æ $xx$ï¼ˆæ²¿ x è½´æåŒ–ï¼‰æˆ– $zz$ï¼ˆæ²¿ z è½´æåŒ–ï¼‰åˆ†é‡ã€‚
- **å¤šæ™¶/æ— åº/ç²‰æœ«æ ·å“**ï¼šå®éªŒæµ‹é‡é€šå¸¸æ˜¯å„å‘åŒæ€§çš„å¹³å‡æ•ˆæœã€‚æ­¤æ—¶æˆ‘ä»¬éœ€è¦å¯¹ä»‹ç”µå¼ é‡çš„**å¯¹è§’å…ƒ**å–ç®—æœ¯å¹³å‡ï¼š
  $$ \epsilon_{\text{iso}}(\omega) = \frac{\epsilon_{xx}(\omega) + \epsilon_{yy}(\omega) + \epsilon_{zz}(\omega)}{3} $$

### 4.1.2 Python è¯»å–è„šæœ¬
æˆ‘ä»¬å°†ä½¿ç”¨ `numpy` è¯»å–æ•°æ®ã€‚è¯·ç¡®ä¿ä½ çš„å·¥ä½œç›®å½•ä¸‹åŒ…å« `pyatb` è¾“å‡ºçš„ `.dat` æ–‡ä»¶ã€‚

```python
import numpy as np

# æ–‡ä»¶è·¯å¾„ï¼ˆè¯·æ ¹æ®å®é™…æƒ…å†µä¿®æ”¹ï¼‰
real_file = 'Out/Optical_Conductivity/dielectric_function_real_part.dat'
imag_file = 'Out/Optical_Conductivity/dielectric_function_imag_part.dat'

def read_dielectric_data(filename):
    """
    è¯»å– pyatb è¾“å‡ºæ–‡ä»¶ï¼Œè¿”å›èƒ½é‡è½´å’Œå„å‘åŒæ€§å¹³å‡åçš„ä»‹ç”µå‡½æ•°
    """
    with open(filename, 'r') as f:
        lines = f.readlines()
    
    # è·³è¿‡è¡¨å¤´ï¼Œè¯»å–æ•°æ®
    data = []
    energy = []
    
    for line in lines[1:]: # Skip header
        parts = line.split()
        if len(parts) < 10: continue
        
        # è§£ææ•°æ®åˆ—
        # æ ¼å¼: omega(eV) xx xy xz yx yy yz zx zy zz
        w = float(parts[0])      # èƒ½é‡ (eV)
        xx = float(parts[1])
        yy = float(parts[5])
        zz = float(parts[9])
        
        # è®¡ç®—å„å‘åŒæ€§å¹³å‡
        avg_val = (xx + yy + zz) / 3.0
        
        energy.append(w)
        data.append(avg_val)
        
    return np.array(energy), np.array(data)

# è¯»å–å®éƒ¨ (epsilon_1) å’Œ è™šéƒ¨ (epsilon_2)
energy, eps_1 = read_dielectric_data(real_file)
_, eps_2 = read_dielectric_data(imag_file)

print(f"æ•°æ®è¯»å–å®Œæˆã€‚èƒ½é‡èŒƒå›´: {energy[0]} - {energy[-1]} eV")
```

---

## 4.2 å¸æ”¶ç³»æ•°è®¡ç®—ä¸å•ä½æ¢ç®— (æ ¸å¿ƒéš¾ç‚¹)

è¿™æ˜¯æœ¬ç« æœ€å®¹æ˜“å‡ºé”™çš„éƒ¨åˆ†ã€‚ç›´æ¥å°†è®¡ç®—å‡ºçš„ä»‹ç”µå‡½æ•°ä»£å…¥å…¬å¼å¾—åˆ°çš„æ•°å€¼ï¼Œå¾€å¾€ä¸å®éªŒå€¼ç›¸å·®åå‡ ä¸ªæ•°é‡çº§ï¼ŒåŸå› å°±åœ¨äº**å•ä½åˆ¶**ã€‚

### 4.2.1 ç‰©ç†å…¬å¼æ¨å¯¼
å¸æ”¶ç³»æ•° $\alpha(\omega)$ å®šä¹‰ä¸ºå…‰å¼ºåœ¨ä»‹è´¨ä¸­ä¼ æ’­å•ä½è·ç¦»åçš„è¡°å‡ç‡ã€‚å®ƒä¸æ¶ˆå…‰ç³»æ•° $\kappa(\omega)$ çš„å…³ç³»ä¸ºï¼š
$$ \alpha(\omega) = \frac{2\omega}{c} \kappa(\omega) $$
å…¶ä¸­æ¶ˆå…‰ç³»æ•° $\kappa$ ç”±ä»‹ç”µå‡½æ•°å®éƒ¨ $\epsilon_1$ å’Œè™šéƒ¨ $\epsilon_2$ å†³å®šï¼š
$$ \kappa(\omega) = \sqrt{ \frac{ \sqrt{\epsilon_1^2 + \epsilon_2^2} - \epsilon_1 }{2} } $$

åˆå¹¶åï¼Œæˆ‘ä»¬å¾—åˆ°è®¡ç®—ç”¨çš„æ ¸å¿ƒå…¬å¼ï¼š
$$ \alpha(\omega) = \frac{\sqrt{2}\omega}{c} \sqrt{ \sqrt{\epsilon_1^2 + \epsilon_2^2} - \epsilon_1 } $$

### 4.2.2 å•ä½æ¢ç®—é€»è¾‘
ABACUS/pyatb è¾“å‡ºçš„èƒ½é‡è½´ $E$ å•ä½æ˜¯ **eV**ï¼Œè€Œå®éªŒå¸¸ç”¨çš„å¸æ”¶ç³»æ•°å•ä½æ˜¯ **$\text{cm}^{-1}$**ã€‚

1.  **é¢‘ç‡ $\omega$ çš„è½¬æ¢**:
    æˆ‘ä»¬æœ‰ $E = \hbar\omega$ï¼Œæ‰€ä»¥ $\omega = E / \hbar$ã€‚
    *   æ™®æœ—å…‹å¸¸æ•° $\hbar \approx 4.135667 \times 10^{-15} \text{ eV}\cdot\text{s}$
    *   æ‰€ä»¥ $\omega [\text{s}^{-1}] = E [\text{eV}] / (4.1357 \times 10^{-15})$

2.  **å…‰é€Ÿ $c$ çš„è½¬æ¢**:
    ä¸ºäº†å¾—åˆ° $\text{cm}^{-1}$ï¼Œå…‰é€Ÿå¿…é¡»ä½¿ç”¨ $\text{cm/s}$ å•ä½ã€‚
    *   $c \approx 2.9979 \times 10^{8} \text{ m/s} = 2.9979 \times 10^{10} \text{ cm/s}$

3.  **æœ€ç»ˆç³»æ•°**:
    å°†å¸¸æ•°æå–å‡ºæ¥ï¼š
    $$ \text{Factor} = \frac{1}{\hbar \cdot c} \approx \frac{1}{4.1357 \times 10^{-15} \times 2.9979 \times 10^{10}} \approx 8065.5 $$
    è¿™æ„å‘³ç€ï¼š$1 \text{ eV}$ çš„èƒ½é‡å¯¹åº”çš„æ³¢æ•°çº¦ä¸º $8065.5 \text{ cm}^{-1}$ã€‚

### 4.2.3 è®¡ç®—è„šæœ¬å®ç°

```python
def calculate_optical_properties(energy_ev, e1, e2):
    """
    è®¡ç®—çº¿æ€§å…‰å­¦æ€§è´¨
    è¾“å…¥:
        energy_ev: å…‰å­èƒ½é‡ (eV)
        e1: ä»‹ç”µå‡½æ•°å®éƒ¨
        e2: ä»‹ç”µå‡½æ•°è™šéƒ¨
    è¾“å‡º:
        n: æŠ˜å°„ç‡
        k: æ¶ˆå…‰ç³»æ•°
        alpha: å¸æ”¶ç³»æ•° (cm^-1)
        L: èƒ½é‡æŸå¤±å‡½æ•°
    """
    # 1. ä¸­é—´å˜é‡æ¨¡é•¿
    # epsilon_complex = e1 + 1j * e2
    # modulus = np.abs(epsilon_complex) = sqrt(e1^2 + e2^2)
    modulus = np.sqrt(e1**2 + e2**2)
    
    # 2. æŠ˜å°„ç‡ n
    n = np.sqrt( (modulus + e1) / 2.0 )
    
    # 3. æ¶ˆå…‰ç³»æ•° k (kappa)
    k = np.sqrt( (modulus - e1) / 2.0 )
    
    # 4. å¸æ”¶ç³»æ•° alpha (cm^-1)
    # å¸¸æ•°å®šä¹‰
    HBAR_eVs = 4.135667696e-15  # Planck constant in eV*s
    C_cm_s   = 2.99792458e10    # Light speed in cm/s
    
    # å°†èƒ½é‡ eV è½¬æ¢ä¸ºè§’é¢‘ç‡ omega (rad/s)
    omega = energy_ev / HBAR_eVs
    
    # å…¬å¼: alpha = 2 * omega * k / c
    alpha = 2.0 * omega * k / C_cm_s
    
    # 5. èƒ½é‡æŸå¤±å‡½æ•° L (EELS)
    L = e2 / (e1**2 + e2**2)
    
    return n, k, alpha, L

# æ‰§è¡Œè®¡ç®—
n, k, alpha, L = calculate_optical_properties(energy, eps_1, eps_2)
```

---

## 4.3 å¤šç‰©ç†é‡å¯è§†åŒ–ä¸åˆ†æ

æœ€åï¼Œæˆ‘ä»¬å°†è®¡ç®—ç»“æœç»˜åˆ¶æˆå›¾ã€‚è¿™é‡Œæˆ‘ä»¬é‡ç‚¹å…³æ³¨**å¸æ”¶ç³»æ•°**å’Œ**èƒ½é‡æŸå¤±å‡½æ•°**ï¼Œå› ä¸ºå®ƒä»¬æœ€å¸¸ç”¨äºä¸å®éªŒå…‰è°±ï¼ˆUV-Vis å¸æ”¶è°±å’Œ EELS è°±ï¼‰è¿›è¡Œå¯¹æ¯”ã€‚

```python
import matplotlib.pyplot as plt

fig, axs = plt.subplots(2, 2, figsize=(12, 10))
fig.suptitle('Calculated Optical Properties of SiO$_2$', fontsize=16)

# 1. æŠ˜å°„ç‡ (Refractive Index)
axs[0, 0].plot(energy, n, 'b-', linewidth=2)
axs[0, 0].set_ylabel('Refractive Index $n$', fontsize=12)
axs[0, 0].set_xlabel('Energy (eV)', fontsize=12)
axs[0, 0].grid(True, alpha=0.3)

# 2. æ¶ˆå…‰ç³»æ•° (Extinction Coefficient)
axs[0, 1].plot(energy, k, 'm-', linewidth=2)
axs[0, 1].set_ylabel('Extinction Coefficient $\kappa$', fontsize=12)
axs[0, 1].set_xlabel('Energy (eV)', fontsize=12)
axs[0, 1].grid(True, alpha=0.3)

# 3. å¸æ”¶ç³»æ•° (Absorption Coefficient)
# æ³¨æ„ï¼šé€šå¸¸ä½¿ç”¨å¯¹æ•°åæ ‡å±•ç¤ºï¼Œå› ä¸ºå¸æ”¶è¾¹å˜åŒ–å‰§çƒˆ
axs[1, 0].plot(energy, alpha, 'r-', linewidth=2)
axs[1, 0].set_ylabel(r'Absorption Coeff. $\alpha$ (cm$^{-1}$)', fontsize=12)
axs[1, 0].set_xlabel('Energy (eV)', fontsize=12)
axs[1, 0].set_yscale('log') # å¯¹æ•°åæ ‡
axs[1, 0].set_ylim(1e2, 1e6) # æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´èŒƒå›´
axs[1, 0].grid(True, alpha=0.3)

# 4. èƒ½é‡æŸå¤±å‡½æ•° (Energy Loss Function)
axs[1, 1].plot(energy, L, 'g-', linewidth=2)
axs[1, 1].set_ylabel('Energy Loss Function $L(\omega)$', fontsize=12)
axs[1, 1].set_xlabel('Energy (eV)', fontsize=12)
axs[1, 1].grid(True, alpha=0.3)

plt.tight_layout()
plt.show()
```

### ç»“æœåˆ†ææŒ‡å—
- **å¸æ”¶è¾¹ (Absorption Edge)**: åœ¨å¸æ”¶ç³»æ•°å›¾ä¸­ï¼Œæ•°å€¼æ€¥å‰§ä¸Šå‡çš„èƒ½é‡ç‚¹é€šå¸¸å¯¹åº”ææ–™çš„å…‰å­¦å¸¦éš™ï¼ˆOptical Bandgapï¼‰ã€‚
- **å³°ä½å¯¹åº”**: èƒ½é‡æŸå¤±å‡½æ•°ä¸­çš„å³°é€šå¸¸å¯¹åº”ç­‰ç¦»æ¿€å…ƒæ¿€å‘ï¼ˆPlasmon resonanceï¼‰ï¼Œè€Œä»‹ç”µå‡½æ•°è™šéƒ¨ $\epsilon_2$ çš„å³°åˆ™å¯¹åº”å¸¦é—´è·ƒè¿ï¼ˆInterband transitionï¼‰ã€‚

---

## é™„å½•ï¼šå¸¸è§é—®é¢˜ä¸è¿›é˜¶å»ºè®® (Troubleshooting)

åœ¨å®é™…æ“ä½œä¸­ï¼Œ90% çš„é”™è¯¯éƒ½å‘ç”Ÿåœ¨ `pyatb` çš„è¾“å…¥æ–‡ä»¶é…ç½®ä¸Šã€‚ä»¥ä¸‹æ˜¯ä¸‰ä¸ªè‡´å‘½é™·é˜±ï¼š

### 1. è´¹ç±³èƒ½çº§é™·é˜± (The Fermi Energy Trap)
**ç°è±¡**: è®¡ç®—å‡ºçš„å…‰è°±å½¢çŠ¶æå…¶æ€ªå¼‚ï¼Œæˆ–è€…å®Œå…¨æ²¡æœ‰å¸æ”¶å³°ã€‚
**åŸå› **: `pyatb` ç›®å‰ç‰ˆæœ¬**ä¸ä¼š**è‡ªåŠ¨ä» `.csr` æˆ– `.orb` æ–‡ä»¶ä¸­è¯»å–è´¹ç±³èƒ½çº§ã€‚å¦‚æœ `Input` æ–‡ä»¶ä¸­çš„ `fermi_energy` å¡«é”™ï¼ˆä¾‹å¦‚å¡«äº† 0 æˆ–é»˜è®¤å€¼ï¼‰ï¼Œç¨‹åºä¼šé”™è¯¯åˆ¤æ–­å æ®æ€å’Œç©ºæ€ï¼Œå¯¼è‡´è·ƒè¿è®¡ç®—å®Œå…¨é”™è¯¯ã€‚
**è§£å†³æ–¹æ¡ˆ**:
å¿…é¡»æ‰‹åŠ¨æŸ¥çœ‹ ABACUS çš„ SCF è¾“å‡ºæ—¥å¿— `running_scf.log` æˆ– `OUT.*/running_scf.log`ã€‚

```bash
# åœ¨ç»ˆç«¯è¿è¡Œ
grep "E_Fermi" OUT.silica/running_scf.log | tail -n 1
```
è¾“å‡ºç¤ºä¾‹ï¼š
```text
E_Fermi                0.4070749075         5.5385382545
```
è¯·åŠ¡å¿…å–**æœ€åä¸€åˆ—**ï¼ˆå•ä½é€šå¸¸ä¸º eVï¼‰çš„æ•°å€¼ï¼Œå¹¶ç²¾ç¡®å¡«å…¥ `pyatb` çš„ `Input` æ–‡ä»¶ä¸­ï¼š
```text
fermi_energy 5.5385382545
fermi_energy_unit eV
```

### 2. å æ®å¸¦æ•°é‡ (Occupied Bands)
**ç°è±¡**: ç¨‹åºæŠ¥é”™æˆ–è®¡ç®—ç»“æœä¸ºé›¶ã€‚
**åŸå› **: `occ_band` å‚æ•°å¿…é¡»å‡†ç¡®å¯¹åº”ä½“ç³»çš„ä»·å¸¦æ•°é‡ã€‚
**è§£å†³æ–¹æ¡ˆ**:
åŒæ ·æŸ¥çœ‹æ—¥å¿—ï¼š
```bash
grep "occupied bands" OUT.silica/running_scf.log
```
è¾“å‡ºç¤ºä¾‹ï¼š
```text
occupied bands = 64
```
åœ¨ `Input` ä¸­å¡«å…¥ï¼š
```text
occ_band 64
```

### 3. æ™¶æ ¼ä¿¡æ¯ç¼ºå¤±é£é™©
**é£é™©**: `pyatb` å¹¶ä¸æ€»æ˜¯èƒ½ä»ç¨€ç–çŸ©é˜µæ–‡ä»¶ä¸­é‡å»ºæ™¶æ ¼ä¿¡æ¯ã€‚
**å»ºè®®**: æ°¸è¿œåœ¨ `pyatb` çš„ `Input` æ–‡ä»¶ä¸­æ˜¾å¼åŒ…å« `LATTICE` å—ï¼Œå†…å®¹ç›´æ¥å¤åˆ¶è‡ª ABACUS çš„ `STRU` æ–‡ä»¶ï¼ˆæ³¨æ„å•ä½è½¬æ¢ï¼ŒABACUS `STRU` é»˜è®¤æ˜¯ Bohrï¼Œpyatb ä¹Ÿæ”¯æŒ Bohrï¼Œä½†éœ€ä¿æŒä¸€è‡´ï¼‰ã€‚

### 4. K ç‚¹æ”¶æ•›æ€§
**åŸç†**: å…‰å­¦æ€§è´¨è®¡ç®—æ¶‰åŠå¸ƒé‡Œæ¸ŠåŒºå†…çš„ç§¯åˆ†ã€‚ç›¸æ¯”äºç”µè·å¯†åº¦ï¼ˆSCFï¼‰ï¼Œå…‰å­¦çŸ©é˜µå…ƒéš k ç‚¹å˜åŒ–æ›´ä¸ºå‰§çƒˆã€‚
**å»ºè®®**: å…‰å­¦æ€§è´¨è®¡ç®—æ‰€éœ€çš„ K ç‚¹å¯†åº¦é€šå¸¸éœ€è¦æ¯” SCF è®¡ç®—å¯† **2-3 å€**ã€‚å¦‚æœå…‰è°±ä¸­æœ‰å¤§é‡éç‰©ç†çš„æ¯›åˆºæˆ–å°–å³°ï¼Œé¦–å…ˆå°è¯•å¢åŠ  `OPTICAL_CONDUCTIVITY` å—ä¸­çš„ `grid` å‚æ•°ï¼ˆä¾‹å¦‚ä» `20 20 20` å¢åŠ åˆ° `40 40 40`ï¼‰ã€‚

---

## é™„å½•
ï¼ˆè‡ªåŠ¨ç”Ÿæˆçš„é™„å½•è§£æå¤±è´¥ï¼Œè¯·æ‰‹åŠ¨è¡¥å……ï¼‰
