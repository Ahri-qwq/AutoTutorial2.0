<!-- META_START -->
# ABACUS 实战教程：自旋极化与磁性材料计算

## 前言
- **本书逻辑**: 本教程遵循“物理原理 -> 简单铁磁计算 -> 复杂反铁磁设置 -> 深入电子结构分析”的递进逻辑。旨在帮助读者从零开始掌握 ABACUS 处理磁性体系的标准流程，特别是如何正确打破自旋对称性以获得正确的基态。
- **核心知识点**: 自旋极化 (Spin Polarization)、铁磁/反铁磁 (FM/AFM) 建模、初始磁矩设置、自旋分辨能带/态密度分析、磁-电耦合效应。

<!-- CHAPTER_START -->
## 第一章：自旋极化计算基础与物理图像
**本章逻辑**: 在动手计算前，必须理解为什么需要开启自旋极化，以及开启后对计算资源和物理结果的影响。这是避免“算出一堆非磁性错误结果”的理论基石。

### Section 1.1: 物理概念：自旋、磁序与对称性破缺
- **内容**: 解释自旋向上 (Spin-up) 和自旋向下 (Spin-down) 的区别。阐述磁性计算的核心在于“对称性破缺”——即必须人为提供一个初始磁矩猜测，否则体系极易收敛到非磁性解。
- **关键参数**: 无

### Section 1.2: 全局参数设置与计算成本
- **内容**: 介绍如何在 `INPUT` 文件中开启自旋极化。重点强调开启后 Kohn-Sham 方程需对两个自旋通道分别求解，计算耗时约为非自旋计算的 2 倍。
- **关键参数**: `nspin` (设置为 2)

<!-- CHAPTER_START -->
## 第二章：铁磁性 (Ferromagnetism) 计算实战
**本章逻辑**: 以最典型的 bcc-Fe 为例，演示最基础的磁性计算流程。这是所有磁性计算的起点。

### Section 2.1: 结构文件与初始磁矩设置
- **内容**: 详解 `STRU` 文件的准备。核心在于如何为原子指定非零的初始磁矩（Initial Magnetic Moment）。**特别注意**：需查阅官方文档确认在 `STRU` 中定义原子磁矩的具体语法（如 `magmom` 或 `start_magnetization` 等标签），这是引导体系进入铁磁态的关键。
- **关键参数**: `nspin=2`, 初始磁矩参数 (待定，需查阅文档确认具体参数名)

### Section 2.2: 自洽计算与收敛性检查
- **内容**: 运行 SCF 计算。教导读者如何检查输出文件，确认最终磁矩是否不为 0（即体系是否保持了磁性）。如果最终磁矩为 0，需讨论如何增大初始猜测值。
- **关键参数**: 无

<!-- CHAPTER_START -->
## 第三章：反铁磁性 (Antiferromagnetism) 进阶设置
**本章逻辑**: 反铁磁计算比铁磁更复杂，因为它要求总磁矩为 0 但局部磁矩不为 0，这通常涉及结构上的特殊处理（超胞或原子标记）。

### Section 3.1: 反铁磁的结构建模策略
- **内容**: 解释为什么单胞（Primitive Cell）可能无法描述反铁磁序（如相邻原子磁矩相反）。介绍如何构建超胞（Supercell）以容纳反平行的磁矩排列。
- **关键参数**: 无

### Section 3.2: 标记原子与指定相反磁矩
- **内容**: 演示如何在 `STRU` 文件中区分同种元素的不同磁性状态（例如将 Fe 分为 Fe_up 和 Fe_down，或通过原子索引指定）。详细说明如何设置 +m 和 -m 的初始磁矩以构建 AFM 构型。
- **关键参数**: 初始磁矩参数 (待定，需查阅文档，需设置为正负相反的值)

<!-- CHAPTER_START -->
## 第四章：自旋分辨的电子结构分析
**本章逻辑**: 算出磁性只是第一步，更重要的是分析磁性对电子结构（能带、DOS、ELF）的影响。本章指导如何处理双通道输出数据。

### Section 4.1: 自旋态密度 (Spin-Resolved DOS)
- **内容**: 解析输出文件 `DOS1` (Up) 和 `DOS2` (Down)。指导如何绘制“镜像”DOS 图（Spin-down 绘制为负值）以直观展示磁性（不对称性）。
- **关键参数**: 无 (涉及输出文件 `DOS1_smearing.dat`, `DOS2_smearing.dat`)

### Section 4.2: 自旋能带结构 (Spin-Resolved Bands)
- **内容**: 处理 `BANDS_1.dat` 和 `BANDS_2.dat`。讨论能带分裂现象，以及如何识别半金属（Half-metal）特性（即一个通道导电，另一个通道绝缘）。
- **关键参数**: 无 (涉及辅助脚本 `gene_band_dat.py`)

### Section 4.3: 实空间分析：电子局域函数 (ELF)
- **内容**: 使用 `ELF_SPIN1.cube` 和 `ELF_SPIN2.cube` 分析不同自旋通道的电子局域化特征。展示如何使用 VESTA 可视化自旋极化的空间分布。
- **关键参数**: 无 (涉及输出文件 `ELF.cube` 等)

<!-- CHAPTER_START -->
## 第五章：外场下的磁性调控 (进阶)
**本章逻辑**: 基于素材中提到的电场效应，介绍如何研究外加场对磁性或能带的调控，展示 ABACUS 的进阶功能。

### Section 5.1: 外加电场设置
- **内容**: 介绍在磁性体系中引入外加电场，观察其对能带分裂（如半导体-金属转变）的影响。
- **关键参数**: `efield_amp` (单位 a.u.)

<!-- APPENDIX_START -->
## 附录：常见问题与排错指南
- **收敛至非磁态**: 初始磁矩过小或对称性未破缺的解决方案。
- **文件混淆**: 再次强调 Spin 1 与 Spin 2 输出文件的对应关系。
- **单位换算**: `efield_amp` 的原子单位换算提示。