<!-- META_START -->
# 《ABACUS 实战教程：晶体弹性常数与力学性质计算》

## 前言
- **本书逻辑**: 本教程遵循“理论基础 -> 零应力基准构建 -> 标准化工作流 -> 复杂体系进阶 -> 结果物理分析”的教学逻辑。从广义胡克定律出发，重点讲解如何利用 ABACUS 的应力计算功能配合 `abacustest` 自动化工具，通过应力-应变法（Stress-Strain Method）获取材料的弹性张量。
- **核心知识点**: 弹性张量与 Voigt 记号、应力-应变法原理、零应力结构优化、`abacustest` 自动化工作流、惯用胞与原胞的选择、力学模量（B, G, E, v）分析。

<!-- CHAPTER_START -->
## 第一章：弹性力学基础与计算原理
**本章逻辑**: 在动手计算之前，必须建立物理图像。本章不涉及具体操作，旨在明确“算什么”和“怎么算”，解释为什么通过微小形变和应力响应可以推导出弹性常数。

### Section 1.1: 广义胡克定律与弹性张量
- **内容**: 介绍材料内部应力（Stress）与应变（Strain）的线性关系。解释四阶弹性张量如何通过晶体对称性和 Voigt 记号简化为 $6 \times 6$ 的对称矩阵。
- **关键参数**: 无（理论概念）。

### Section 1.2: 第一性原理计算中的应力-应变法
- **内容**: 阐述计算策略——对晶胞施加一系列线性无关的微小应变（正应变与剪切应变），利用 DFT 计算对应的柯西应力，通过线性拟合求解弹性常数矩阵。
- **关键参数**: `cal_stress` (ABACUS 中开启应力计算的关键开关)。

<!-- CHAPTER_START -->
## 第二章：计算准备——构建“零应力”基准
**本章逻辑**: 弹性常数对应力极其敏感。任何初始结构中的残余应力都会导致结果偏差。本章重点讲解如何获得完美的初始结构，这是计算成功的基石。

### Section 2.1: 晶胞的选择：惯用胞 vs 原胞
- **内容**: 探讨对于立方晶系（如 Si, Cu），为何强烈推荐使用惯用胞（Conventional Cell）而非原胞。解释坐标轴与晶格矢量重合对于直接获取物理直观的 $C_{11}, C_{12}, C_{44}$ 的重要性。
- **关键参数**: 无（涉及结构文件 `STRU` 的准备）。

### Section 2.2: 消除残余应力：高精度结构优化
- **内容**: 使用 ABACUS 进行 `cell-relax` 计算。强调此时的收敛标准应严于常规计算，以确保初始结构的应力张量接近于零。
- **关键参数**: 
    - `calculation`: `cell-relax`
    - `cal_stress`: `1`
    - `cal_force`: `1`
    - `basis_type`: `lcao` (或 `pw`)
    - `scf_thr`, `force_thr`, `stress_thr` (建议设置高精度收敛标准)

<!-- CHAPTER_START -->
## 第三章：标准工作流实战——以硅（Si）为例
**本章逻辑**: 以最简单的立方晶系为例，引入 `abacustest` 工具，展示从输入生成、任务提交到后处理的完整自动化流程。

### Section 3.1: 使用 abacustest 准备应变任务
- **内容**: 介绍 `abacustest` 的 `elastic` 模块。演示如何基于优化后的结构，自动生成包含不同正应变和剪切应变（如 $\pm 0.5\%$, $\pm 1\%$）的输入文件目录结构。
- **关键参数**: 
    - `abacustest` 参数: `--norm` (最大正应变), `--shear` (最大剪切应变)
    - ABACUS INPUT 参数: `calculation` (通常设为 `relax` 或 `scf`), `cal_stress`: `1`

### Section 3.2: 变形结构的计算策略：Relax vs SCF
- **内容**: 讨论在施加应变后，是进行固定晶胞的原子弛豫（Relaxed-ion elastic constants）还是仅进行电子步计算（Clamped-ion）。解释 `abacustest` 中 `--norelax` 参数的物理含义及默认行为（推荐进行原子弛豫以符合宏观物理测量）。
- **关键参数**: 
    - `calculation`: `relax` (推荐) 或 `scf`
    - `symmetry`: (需确认是否需要手动关闭以防止对称性强制导致的误差)

### Section 3.3: 结果后处理与数据拟合
- **内容**: 使用 `abacustest` 自动收集所有子任务的应力数据，拟合弹性张量，并输出 $C_{11}, C_{12}, C_{44}$ 及体模量、剪切模量等宏观性质。
- **关键参数**: `abacustest` 参数: `--post`

<!-- CHAPTER_START -->
## 第四章：进阶案例与各向异性——金红石型 TiO2
**本章逻辑**: 从高对称性迈向低对称性。通过四方晶系 TiO2 的案例，展示各向异性材料的计算特点以及如何验证结果的可靠性。

### Section 4.1: 处理各向异性与晶体取向
- **内容**: 针对非立方晶系，介绍 IEEE 标准取向的重要性。演示如何处理金红石型 TiO2 的结构，使其符合 Materials Project 数据库的对比标准。
- **关键参数**: 无（侧重结构预处理）。

### Section 4.2: 独立弹性常数分析与实验对比
- **内容**: 分析四方晶系（Laue类型 I）存在的 6 个独立弹性张量元（$C_{11}, C_{12}, C_{13}, C_{33}, C_{44}, C_{66}$）。展示如何将计算结果与实验值及数据库值进行对比，验证计算精度。
- **关键参数**: 无（侧重数据分析）。

<!-- APPENDIX_START -->
## 附录：常见问题与最佳实践
- **常见坑点**: 
    - 残余应力未消除导致的负模量问题。
    - 应变幅度选择过大（超出线弹性区）或过小（被数值噪音淹没）的影响。
    - `abacustest` 文件覆盖风险提示。
- **进阶建议**: 
    - K 点密度与平面波截断能（`ecutwfc`）对 Pulay 应力的影响。
    - 磁性体系（`nspin`）弹性常数计算的注意事项。