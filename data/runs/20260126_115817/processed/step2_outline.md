<!-- META_START -->
# 《ABACUS 核心进阶：赝势与数值原子轨道 (UPF/APNS) 的匹配与应用》

## 前言
- **本书逻辑**: 本教程遵循“物理原理 -> 资源获取 -> 参数配置 -> 策略选择”的认知路径。首先确立“赝势与轨道必须严格匹配”的核心物理原则，随后介绍官方推荐的 APNS 资源库及其命名规则，接着深入讲解如何在 ABACUS 输入文件中正确配置这些文件，最后根据具体的科研场景（如结构优化 vs 能带计算）指导用户选择合适的精度版本。
- **核心知识点**: 模守恒赝势 (NC-PP) 与数值原子轨道 (NAO) 的对应关系、APNS-PPORB 库的使用、`ecutwfc` 等关键截断能参数的设置、精度 (Precision) 与效率 (Efficiency) 版本的应用场景区分。

<!-- CHAPTER_START -->
## 第一章：物理基础与匹配原则
**本章逻辑**: 在动手操作前，必须先建立正确的物理图像。本章旨在解释为什么 ABACUS 的 LCAO 模式需要特定的轨道文件，以及为什么“乱点鸳鸯谱”（随意搭配赝势和轨道）会导致计算失败。

### Section 1.1: 赝势与数值原子轨道 (NAO) 概论
- **内容**: 简述 DFT 计算中赝势 (Pseudopotential) 的作用（替代内核电子，平滑波函数）以及 ABACUS 中数值原子轨道 (NAO) 的角色（LCAO 基组）。重点阐述模守恒赝势 (Norm-Conserving/ONCV) 是目前 ABACUS 的主要支持对象，并指出超软赝势 (USPP) 目前尚处于实验或不支持阶段，建议用户保守选择 NC 赝势。
- **关键参数**: `basis_type` (设置为 lcao 或 pw)

### Section 1.2: 核心铁律——匹配性原则
- **内容**: 详细解释“轨道必须由特定赝势生成”的物理原因。强调完备性与正交性依赖于生成时的势场环境。明确警告：严禁将来源于不同库（如 SG15 赝势配其他来源轨道）混用，除非经过严格测试。
- **关键参数**: 无

<!-- CHAPTER_START -->
## 第二章：APNS 资源库与文件解析
**本章逻辑**: 了解了原理后，用户需要知道“去哪里下载”以及“如何读懂文件名”。本章聚焦于官方推荐的 APNS-PPORB 捆绑包，这是解决匹配痛点的最佳方案。

### Section 2.1: APNS-PPORB 捆绑包概览
- **内容**: 介绍 ABACUS 官方推出的 APNS-PPORB-v1 项目。说明其覆盖范围（H 到 Bi，不含 La 系/Ac 系），以及获取渠道（AIS-Square, GitHub）。提及对于高级用户，也可利用 CP2K 接口生成兼容文件。
- **关键参数**: 无

### Section 2.2: 解读文件名中的“密码”
- **内容**: 教授用户如何从文件名中提取关键计算参数。以 `C_gga_9au_100Ry_3s3p2d.orb` 为例，拆解 `9au` (截断半径 rcut)、`100Ry` (推荐 ecutwfc)、`3s3p2d` (轨道构型) 的含义及其对计算成本的影响。
- **关键参数**: 待定 (需查阅文件名中的数值)

<!-- CHAPTER_START -->
## 第三章：输入文件配置实战
**本章逻辑**: 拿到文件后，如何让 ABACUS 跑起来？本章将具体的物理参数映射到 `STRU` 和 `INPUT` 文件的编写规则中，落实操作细节。

### Section 3.1: STRU 文件中的双重指定
- **内容**: 讲解如何在 `STRU` 文件中同时指定赝势文件 (`.upf`) 和轨道文件 (`.orb`)。特别提醒读者，具体的 `ATOMIC_SPECIES` 和 `NUMERICAL_ORBITAL` 模块写法需查阅 ABACUS 官方文档，确保路径准确。
- **关键参数**: `ATOMIC_SPECIES`, `NUMERICAL_ORBITAL` (STRU 文件模块名)

### Section 3.2: 关键截断能参数设置
- **内容**: 解释为何在 LCAO 模式下仍需设置平面波截断能。指导用户根据轨道文件名中的建议值设置 `ecutwfc`，并按 `4 * ecutwfc` 的经验法则设置 `ecutrho`。强调 `ecutwfc` 过低会导致积分误差，过高则浪费算力。
- **关键参数**: `ecutwfc`, `ecutrho`

<!-- CHAPTER_START -->
## 第四章：场景化策略——精度与效率的博弈
**本章逻辑**: 既然 APNS 提供了 `efficiency` 和 `precision` 两个版本，用户该如何选择？本章从实际科研任务出发，提供决策指南，避免“杀鸡用牛刀”或“因陋就简”。

### Section 4.1: Efficiency 版本：高通量与动力学的首选
- **内容**: 定义 `efficiency` 版本的适用范围（仅需占据态性质）。推荐用于结构优化、分子动力学 (MD)、声子谱计算等场景。分析其优势：较小的基组和截断半径带来的速度提升。
- **关键参数**: 无 (主要涉及轨道文件选择)

### Section 4.2: Precision 版本：电子结构与激发态的基石
- **内容**: 定义 `precision` 版本的适用范围（需要高完备性/空带精度）。推荐用于能带计算（费米面以上）、TD-DFT、高精度能量计算。指出误用 Efficiency 版本计算激发态可能导致的风险。
- **关键参数**: 无 (主要涉及轨道文件选择)

### Section 4.3: 局限性与特殊情况
- **内容**: 明确指出 APNS-PPORB-v1 目前**不支持旋轨耦合 (SOC)** 计算。若需进行 SOC 计算，需寻找其他专用资源或等待后续版本。同时区分 OFDFT 计算需使用 BLPS 赝势而非 UPF。
- **关键参数**: `lspinorb` (若开启此参数，则不能使用当前 v1 版 APNS)

<!-- APPENDIX_START -->
## 附录：常见陷阱与避坑指南
- **文件名误读风险**: 盲目追求大 `au` 值（截断半径）导致计算极其缓慢。
- **参数不一致**: `INPUT` 中的 `ecutwfc` 小于轨道文件名推荐值，导致严重的数值积分错误。
- **文件路径错误**: 在 `STRU` 中复制粘贴导致轨道文件与元素不匹配。
- **OFDFT 混淆**: 误将 KS-DFT 的 UPF 赝势用于无轨道密度泛函计算。