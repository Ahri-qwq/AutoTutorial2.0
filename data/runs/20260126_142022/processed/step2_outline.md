<!-- META_START -->
# ABACUS 实战：数值原子轨道截断半径 ($R_{cut}$) 的基准测试与选取策略

## 前言
- **本书逻辑**: 本教程旨在解决 LCAO 计算中“精度”与“效率”博弈的核心问题。逻辑上遵循“物理原理认知 -> 确立平面波(PW)基准 -> LCAO 变参测试 -> 误差分析与决策”的科学实验流程。重点纠正“在 INPUT 中直接修改 Rcut”的常见误区，强调“以更换轨道文件为手段”的操作范式。
- **核心知识点**: 数值原子轨道(NAO)的局限性、平面波基准(Benchmark)的建立、STRU 文件中轨道配置的修改、能量/能带收敛性分析、BSSE 对 Rcut 的特殊要求。

<!-- CHAPTER_START -->
## 第一章：物理基础——为何 Rcut 是效率与精度的平衡点？
**本章逻辑**: 在动手操作前，必须让读者理解 $R_{cut}$ 的物理本质。本章从 NAO 与 PW 的对比切入，解释截断半径如何决定哈密顿量的稀疏度（影响速度）和基组的完备性（影响精度）。

### Section 1.1: 数值原子轨道 (NAO) 的空间局域性
- **内容**: 阐述 NAO 与平面波(PW)的根本区别。解释 $R_{cut}$ 定义了波函数的强制归零边界，以及这一特性如何导致矩阵稀疏化，从而降低内存消耗并加速计算。
- **关键参数**: 无 (理论概念)。

### Section 1.2: 截断半径的双刃剑效应
- **内容**: 分析 $R_{cut}$ 过小导致的“长程尾部丢失”和“基组不完备”问题，以及 $R_{cut}$ 过大导致的计算量激增和内存溢出风险。引入“收敛性测试”的必要性。
- **关键参数**: 无 (理论概念)。

<!-- CHAPTER_START -->
## 第二章：确立“标准答案”——平面波 (PW) 基准计算
**本章逻辑**: 没有对比就没有伤害。LCAO 的精度必须相对于完备基组（PW）来评估。本章指导读者先运行一个高精度的 PW 计算，作为后续测试的 Reference。

### Section 2.1: 准备 PW 计算环境
- **内容**: 设置 ABACUS 进入平面波模式。强调 PW 计算不依赖轨道文件，仅依赖赝势和能量截断。
- **关键参数**: 
    - `basis_type`: 设置为 `pw`。
    - `ecutwfc`: 设置足够高的值（如 100 Ry）以保证基准精度。

### Section 2.2: 获取基准物理量
- **内容**: 运行计算并提取关键数据（总能量、费米能级、能带结构或力）。这些数据将作为后续计算 Delta 值的减数。
- **关键参数**: 无 (数据提取操作)。

<!-- CHAPTER_START -->
## 第三章：实战演练——通过更换轨道文件测试 Rcut
**本章逻辑**: 这是教程的核心操作部分。重点纠正初学者试图在 INPUT 文件中寻找 `rcut` 参数的错误直觉，明确“文件名即参数”的操作逻辑。

### Section 3.1: 轨道文件的准备与识别
- **内容**: 讲解如何识别轨道文件名中的 Rcut 信息（如 `Si_7au.orb` vs `Si_8au.orb`）。说明如果需要自定义 Rcut，需提前使用轨道生成程序（如 PTG）生成一系列文件。
- **关键参数**: 
    - `Rcut`: (仅在轨道生成阶段涉及，单位 Bohr/au)。

### Section 3.2: LCAO 计算参数设置 (INPUT)
- **内容**: 配置 LCAO 模式的基本参数。特别强调 `ecutwfc` 在 LCAO 中的作用（控制积分网格精度）及其与 $R_{cut}$ 的无关性。
- **关键参数**: 
    - `basis_type`: 设置为 `lcao`。
    - `ecutwfc`: 推荐 100 Ry (需保持与 PW 基准一致或足够高)。

### Section 3.3: 核心操作——修改 STRU 文件
- **内容**: 演示如何保持 `ATOMIC_POSITIONS` 不变，仅修改 `ATOMIC_SPECIES` 下的轨道文件路径，从而实现 $R_{cut}$ 的变更。建立一个测试序列（如 6au -> 7au -> 8au）。
- **关键参数**: 
    - `orbital_file`: (在 STRU 文件中指定具体的 .orb 路径)。

<!-- CHAPTER_START -->
## 第四章：数据分析与决策——寻找最优 Rcut
**本章逻辑**: 算出数据后如何评估？本章提供定量的收敛标准，并针对不同体系（固体 vs 分子）给出经验法则。

### Section 4.1: 能量与能带的误差分析 (Delta Test)
- **内容**: 计算 $E_{LCAO}(R_{cut}) - E_{PW}$ 的差值。定义高精度标准（如 < 1 meV/atom）。绘制 "Delta E vs. Rcut" 曲线。
- **关键参数**: 无 (数据分析)。

### Section 4.2: 不同体系的选取策略
- **内容**: 
    - **固体体系**: 解释为何近邻重叠允许使用较短的 Rcut (推荐 6-8 au)。
    - **分子/表面体系**: 解释 BSSE 问题，强调真空层中长程衰减的重要性，推荐使用较大 Rcut (10 au) 或开启 BSSE 校正。
- **关键参数**: 无 (策略建议)。

<!-- APPENDIX_START -->
## 附录：常见陷阱与进阶
- **SZ vs DZP 的陷阱**: 警告不要在 SZ 基组上做 Rcut 测试（精度本身不够），测试应至少基于 DZP。
- **内存溢出 (OOM)**: 提示大 Rcut (>10 au) 配合大基组可能导致内存崩溃的解决方案。
- **赝势一致性**: 再次强调 PW 和 LCAO 计算必须使用完全相同的 `.upf` 文件。