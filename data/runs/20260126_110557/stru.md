# ABACUSå…¥é—¨æ•™ç¨‹ - ç»“æ„æ–‡ä»¶STRU

åœ¨ä½¿ç”¨ABACUSå¼€å±•è®¡ç®—ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å‡†å¤‡å¥½ABACUSè®¡ç®—ç”¨çš„è¾“å…¥æ–‡ä»¶ï¼Œè¿™äº›è¾“å…¥æ–‡ä»¶ä¸»è¦åŒ…æ‹¬ï¼š

STRUæ–‡ä»¶ï¼šABACUSçš„ç»“æ„æ–‡ä»¶æ ¼å¼ï¼Œå¯ç±»æ¯”VASPçš„POSCARã€‚

INPUTæ–‡ä»¶ï¼šå¼€å±•ABACUSè®¡ç®—çš„è¾“å…¥å‚æ•°é›†åˆï¼Œå¯ç±»æ¯”VASPçš„INCARã€‚

KPTæ–‡ä»¶ï¼šABACUSçš„Kç‚¹æ–‡ä»¶æ ¼å¼ï¼Œä»£è¡¨äº†å¼€å±•ç¬¬ä¸€æ€§åŸç†è®¡ç®—æ—¶çš„Kç©ºé—´é‡‡æ ·æƒ…å†µï¼Œå¯ç±»æ¯”VASPçš„KPOINTSã€‚

å…¶ä¸­ï¼Œç»“æ„æ–‡ä»¶STRUçš„å‡†å¤‡æ˜¯ABACUSè¾“å…¥æ–‡ä»¶å‡†å¤‡çš„é‡è¦ä¸€ç¯ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œç”¨æˆ·çš„ç»“æ„æ–‡ä»¶æ¥æºä¸»è¦åŒ…æ‹¬ï¼š

è‡ªè¡Œé€šè¿‡Materials Studio Visualizerç­‰æ™¶ä½“ç»“æ„å»ºæ¨¡å¯è§†åŒ–è½¯ä»¶æ„å»ºç»“æ„æ¨¡å‹ï¼Œå¹¶ä¿å­˜ä¸ºè¿™ä¸€å»ºæ¨¡è½¯ä»¶æ‰€æ”¯æŒçš„æ ¼å¼ã€‚

ä»Materials Projectç­‰æ™¶ä½“ç»“æ„æ•°æ®åº“ä¸Šä¸‹è½½çš„ç»“æ„æ–‡ä»¶ï¼ˆå¤šä¸ºCIFæ ¼å¼ï¼‰ã€‚

å…¶ä»–æ¥æºï¼Œå¦‚æ±‚è§£æ™¶ä½“è¡¨å¾è°±å›¾å¾—åˆ°çš„CIFæ–‡ä»¶ï¼Œä»æ–‡çŒ®ä¸­è·å–çš„ç»“æ„æ–‡ä»¶ç­‰ã€‚

è¿™äº›ç»“æ„æ–‡ä»¶çš„æ ¼å¼å¤§å¤šä¸ºCIFï¼ŒPOSCARï¼ŒXSDç­‰ï¼Œä¸ä¼šç›´æ¥æ˜¯ABACUSçš„STRUæ–‡ä»¶ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•å‡†å¤‡ABACUSçš„ç»“æ„æ–‡ä»¶å‘¢ï¼Ÿ

ä¸æ­¤åŒæ—¶ï¼Œåœ¨ABACUSè®¡ç®—å®Œæˆä¹‹åï¼Œæˆ‘ä»¬æœ‰æ²¡æœ‰å°†è®¡ç®—ç»“æœè½¬åŒ–ä¸ºå¯è¢«å¸¸è§çš„æ™¶ä½“ç»“æ„å»ºæ¨¡å¯è§†åŒ–è½¯ä»¶å¯¼å…¥å¹¶å¯è§†åŒ–çš„å¸¸è§ç»“æ„æ–‡ä»¶æ ¼å¼ï¼ˆå¦‚CIFï¼‰çš„æ–¹æ³•ï¼Ÿ

ASEï¼ˆAtomic Simulation Environmentï¼‰æ˜¯å¼€æºçš„åŸå­å°ºåº¦æ¨¡æ‹ŸPythonå·¥å…·åº“ï¼Œç”±ä¸¹éº¦æŠ€æœ¯å¤§å­¦ï¼ˆDTUï¼‰ç­‰æœºæ„å¼€å‘ï¼Œå¹¿æ³›åº”ç”¨äºè®¡ç®—ææ–™ç§‘å­¦å’Œåˆ†å­æ¨¡æ‹Ÿé¢†åŸŸã€‚è¯¥å·¥å…·åº“æ”¯æŒå¤šç§ç¬¬ä¸€æ€§åŸç†è½¯ä»¶ï¼ŒABACUSä¹Ÿæœ‰ASE-ABACUSæ¥å£ï¼Œä¸è¿‡è¿™ä¸€æ¥å£æ˜¯ç‹¬ç«‹äºASEä¸»ä»“åº“ä»¥å¤–çš„åˆ†æ”¯ï¼Œéœ€è¦å•ç‹¬ä¸‹è½½å®‰è£…ã€‚å®‰è£…æ–¹å¼ï¼š

`# install ase-abacus`

git clone https://gitlab.com/1041176461/ase-abacus.git

cd ase-abacus

pip install .

# use tsinghua mirror in CN internet if needed

# pip install . -i https://mirrors.tuna.tsinghua.edu.cn/pypi/web/simple


å®‰è£…å¥½äº†ä¹‹åå°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªASEæ¥å‡†å¤‡STRUæ–‡ä»¶äº†ã€‚æœ‰ä¸¤ç§å¯è¡Œæ–¹å¼ï¼Œä¸€ç§æ˜¯ç›´æ¥åŸºäºASEæ„å»ºç»“æ„æ–‡ä»¶å¹¶å¯¼å‡ºä¸ºSTRUæ ¼å¼ã€‚æ¯”å¦‚ä»¥ä¸‹Pythonè„šæœ¬ï¼ˆæˆ–IPythonå‘½ä»¤è¡Œï¼‰ï¼š

`from ase.build import bulk`

from ase.io import write


structure = bulk("Al", "fcc")

write("STRU", structure, format='abacus')


å¦‚æ­¤å³å¯å¾—åˆ°FCC Alçš„ä¸€ä¸ªæœ€ç®€å•çš„STRUæ–‡ä»¶ï¼Œå®ƒæ˜¯FCC Alçš„åŸèƒã€‚

æ³¨ï¼šé€šè¿‡pip install aseå¯ä»¥ä¸‹è½½åˆ°PyPiä¸Šå®˜æ–¹çš„ASEï¼Œä½†è¿™ä¸ªASEé‡Œæ²¡æœ‰æ¥å…¥ABACUSçš„éƒ¨åˆ†æ”¯æŒã€‚ASE-ABACUSæ˜¯ASEçš„ä¸€ä¸ªæ´¾ç”Ÿåˆ†æ”¯ï¼Œä¸“ç”¨äºASEçš„ABACUSæ”¯æŒï¼ŒåŒæ—¶å…¼å®¹ASEæœ¬ä½“ã€‚


é€šè¿‡ä¸Šè¿°æœ€ç®€å•çš„æ–¹å¼å‡†å¤‡çš„STRUæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š

`ATOMIC_SPECIES`

Al 26.9815385 Al_ONCV_PBE-1.0.upf


NUMERICAL_ORBITAL

Al_gga_7au_100Ry_4s4p1d.orb


LATTICE_CONSTANT

1.8897261258369282


LATTICE_VECTORS

0.0000000000 2.0250000000 2.0250000000

2.0250000000 0.0000000000 2.0250000000

2.0250000000 2.0250000000 0.0000000000


ATOMIC_POSITIONS

Direct


Al

0.0000000000

1

0.0000000000 0.0000000000 0.0000000000 1 1 1 mag 0.0



å…ƒç´ ç±»åˆ«ä¿¡æ¯ã€‚åŒ…æ‹¬å…ƒç´ ç¬¦å·ï¼Œæ‘©å°”è´¨é‡ï¼ŒèµåŠ¿æ–‡ä»¶åç§°ã€‚

åŸå­è½¨é“æ–‡ä»¶åç§°ã€‚åœ¨ä½¿ç”¨åŸå­è½¨é“åŸºç»„è®¡ç®—æ—¶ä½¿ç”¨ã€‚

æ™¶æ ¼å¸¸æ•°å•ä½ã€‚ABACUSçš„é»˜è®¤é•¿åº¦å•ä½ä¸ºBohrï¼Œè¿™ä¸€æ™¶æ ¼å¸¸æ•°å°†æ‰€æœ‰é•¿åº¦æ”¾å¤§1.889726å€ï¼Œå°†é•¿åº¦å•ä½Bohrè½¬åŒ–ä¸ºæ›´ä¸ºäººç†ŸçŸ¥çš„åŸƒï¼ˆAngstromï¼‰ã€‚

æ™¶æ ¼çŸ¢é‡ï¼Œä¸ºä¹åˆ†é‡å½¢å¼ã€‚

åŸå­åæ ‡ç±»åˆ«ï¼šæœ‰å¤šç§é€‰é¡¹ï¼Œå¯ä»¥åœ¨docs: atomic-positionsï¼ˆhttps://abacus.deepmodeling.com/en/latest/advanced/input_files/stru.html#atomic-positionsï¼‰å¤„æŸ¥çœ‹ï¼Œå¸¸è§é€‰é¡¹åŒ…æ‹¬åˆ†æ•°åæ ‡Directï¼Œç¬›å¡å°”åæ ‡Cartesianã€‚

æ³¨ï¼šè¿˜æœ‰ä¸ªCartesian_angstromé€‰é¡¹å¯ä»¥é¿å…å¯¹æ™¶æ ¼åæ ‡å•ä½LATTICE_CONSTANTçš„æ˜¾å¼æŒ‡å®šï¼Œç›´æ¥ä»¥åŸƒä¸ºå•ä½ï¼Œä¸è¿‡è¿™ä¸€é€‰é¡¹åœ¨å„ä¸ªæ¥å£è½¯ä»¶ä¸­æ”¯æŒçš„ä¸å¤šï¼Œä¹Ÿä¸å¹¿ä¸ºäººçŸ¥ã€‚


`Al #å…ƒç´ ç±»åˆ«`

0.0000000000 # è¯¥å…ƒç´ æ¯ä¸ªåŸå­çš„ç£çŸ©ï¼ˆä½ä¼˜å…ˆçº§ï¼‰

1 # è¯¥å…ƒç´ åŒ…å«çš„åŸå­æ•°ç›®

0.0000000000 0.0000000000 0.0000000000 1 1 1 mag 0.0

# åæ ‡x,y,z; åŸå­åœ¨x,y,zæ–¹å‘æ˜¯å¦å¯åŠ¨ï¼ˆ1ä»£è¡¨å¯åŠ¨ï¼‰ï¼ŒåŸå­ç£çŸ©ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰


é™¤äº†åŸºäºASEæ„å»ºçš„ç»“æ„å‡†å¤‡STRUå¤–ï¼Œæ›´å¸¸è§çš„æ˜¯ï¼Œç”¨æˆ·å·²ç»æœ‰è‡ªå·±æƒ³åšè®¡ç®—çš„è¾“å…¥ç»“æ„ï¼Œåªæ˜¯è¦æŠŠå®ƒè½¬åŒ–ä¸ºSTRUæ ¼å¼ï¼Œè¿™ä¸€ç‚¹ASE-ABACUSå½“ç„¶ä¹Ÿæ”¯æŒï¼Œä»¥å¦‚ä¸‹FCC Alçš„CIFæ–‡ä»¶ä¸ºä¾‹ï¼š

`data_image0`

_chemical_formula_structural Al

_chemical_formula_sum "Al1"

_cell_length_a 2.8637824638055176

_cell_length_b 2.8637824638055176

_cell_length_c 2.8637824638055176

_cell_angle_alpha 60.00000000000001

_cell_angle_beta 60.00000000000001

_cell_angle_gamma 60.00000000000001


_space_group_name_H-M_alt "P 1"

_space_group_IT_number 1


loop_

_space_group_symop_operation_xyz

'x, y, z'


loop_

_atom_site_type_symbol

_atom_site_label

_atom_site_symmetry_multiplicity

_atom_site_fract_x

_atom_site_fract_y

_atom_site_fract_z

_atom_site_occupancy

Al Al1 1.0 0.0 0.0 0.0 1.0000



æ¯”è¾ƒç®€å•çš„Pythonæ“ä½œæ–¹å¼å¦‚ä¸‹ï¼š

`from ase.io import read, write`

# read existing cif file

Al_fcc = read("Al.cif", format="cif")

# write this structure to STRU

write("STRU", Al_fcc, format='abacus')


å¦‚æœæƒ³è‡ªè¡ŒæŒ‡å®šè¾“å‡ºçš„èµåŠ¿æ–‡ä»¶å’Œè½¨é“æ–‡ä»¶ï¼Œå¯ä»¥è¿™ä¹ˆå†™ä½ çš„Pythonè„šæœ¬ï¼š

`from ase.io import read, write`

Al_fcc = read("Al.cif", format="cif")

# specify pseudopot from APNS-v1.0

pp = {"Al": "Al.upf"}

# specify orbital from APNS-v1.0

basis = {"Al": "Al_gga_8au_100Ry_2s2p1d.orb"}

write("STRU", Al_fcc, format='abacus', pp=pp, basis=basis)



`# Set up the environment for ABACUS`

PP=${HOME}/pseudopotentials # èµåŠ¿æ–‡ä»¶è·¯å¾„

ORB=${HOME}/orbitals # è½¨é“æ–‡ä»¶è·¯å¾„

export ABACUS_PP_PATH=${PP} # è®¾ç½®ç¯å¢ƒå˜é‡

export ABACUS_ORBITAL_PATH=${ORB} # è®¾ç½®ç¯å¢ƒå˜é‡


ATOMKITç”±VASPKITå¼€å‘å›¢é˜Ÿå¼€å‘ï¼Œæä¾›äº†å¦ä¸€ç§é€‰é¡¹ï¼šé€šè¿‡å‘½ä»¤è¡Œäº¤äº’æ–¹å¼ï¼Œé›†æˆæ™¶ä½“ç»“æ„æ“ä½œã€å»ºæ¨¡ã€æ ¼å¼è½¬åŒ–åŠå¯è§†åŒ–ï¼Œå¹¶å¯è¾“å‡ºå¤šç§å¸¸è§ææ–™æ¨¡æ‹Ÿè½¯ä»¶ç»“æ„æ–‡ä»¶æ ¼å¼ã€‚åŒæ—¶ï¼ŒATOMKITå…¼å…·ä¸€å®šçš„å¯è§†åŒ–åŠŸèƒ½ã€‚

å…¶æœ€æ–°ç‰ˆå¯åœ¨æ­¤å¤„ä¸‹è½½ï¼š

ä¸‹è½½å¥½äº†ä¹‹åï¼Œç›´æ¥è§£å‹ï¼Œç„¶åå®‰è£…å³å¯ï¼Œå¦‚ï¼š

`# under target directory`

tar -zxvf atomkit.0.9.0.linux.x64.tar.gz

cd atomkit.0.9.0.linux.x64

bash setup.sh

# reload your system environment

source ~/.bashrc



` ~> atomkit`

\\\///

/ _ _ \

(| (o)(o) |)

o-----.OOOo--()--oOOO.------------------------------------------o

| ATOMKIT Standard Edition 0.9.0 (26 Mar. 2024) |

| Lead Developer: Vei WANG (wangvei@icloud.com) |

| Contributors: Zhao-Ke WANG, Gang TANG, Ya-Chao LIU |

o-----.oooO-----------------------------------------------------o

( ) Oooo. ATOMKIT Made Simple

\ ( ( )

\_) ) /

(_/

===================== Structural Utilities ======================

1) Export Structures 2) Symmetry Analysis

3) Generate K-Mesh & K-Path 4) Edit Structure

5) Advanced Structure Models 6) 2D-Material Kit

8) Visualize Structure 0) Quit

------------>>



`1`

+---------------------------- Tip ------------------------------+

| Supplementary parameters from GLOBAL_PARAMETERS.in will be |

| automatically copied to the exported file, if available. |

+---------------------------------------------------------------+

===================== Export Format Options =====================

101) ABACUS (*.stru) 102) ABINIT (*.in)

105) ASE (*.py) 107) ATAT (*.in)

109) AtomEye (*.cfg) 112) CASTEP (*.cell)

113) CIF Format (*.cif) 114) CP2K (*.inp)

115) CPMD (*.inp) 123) Elk (*.in)

124) exciting (*.xml) 126) DFTB+ (*.hsd)

127) DMol3 (*.incoor) 129) FHI-aims (*.in)

132) FLEUR (*.inp) 134) Gaussian (*.gjf)

136) LAMMPS (*.lmp) 138) JDFTx (*.in)

142) Octopus (*.in) 144) OpenMX (*.in)

146) ORCA (*.in) 149) PDB Format (*.pdb)

156) Quantum-Espresso (*.in) 165) RSPt (*.inp)

168) Siesta (*.fdf) 175) VASP (*.vasp)

180) Wannier90 (*.win) 182) WIEN2K (*.struct)

185) XCrySDen (*.xsf) 189) XYZ Format (*.xyz)


0) Quit

9) Back

------------>>



`101`


===================== Import Format Options =====================

101) ABACUS (STRU) 112) CASTEP (*.cell)

113) CIF Format (*.cif) 123) Elk (*.in)

134) Gaussian (*.gjf) 142) Materials Studio (*.xsd)

144) MDL Molfile Format (*.mol) 149) PDB Format (*.pdb)

156) Quantum-Espresso (*.in) 168) Siesta (*.fdf)

175) VASP (POSCAR, *.vasp) 185) XCrySDen (*.xsf)

189) XYZ Format (*.xyz)

190) Build Crystal from Wyckoff Positions & Space Group Number


+---------------------------- Tip ------------------------------+

| Examples of Usage: |

| 113 Si.cif: Read structure from Si.cif file with cif format |

| 175 POSCAR: Read structure from POSCAR file with VASP format |

| 190 INPUT: Build crystal From Wyckoff positions in INPUT file|

+---------------------------------------------------------------+

Input the code-ID listed above and the filename to be read:



`113 Al.cif`

-->> (01) Reading Structure from Al.cif File...

+---------------------------------------------------------------+

| This utility is in experimental stage & needs to be improved. |

+---------------------------------------------------------------+

+---------------------------------------------------------------+

Species and Wyckoff Sites

[Al] 0.000 0.000 0.000

+---------------------------------------------------------------+

| Cell Parameters After Applying Symmetry Operations |

+---------------------------------------------------------------+

Import File Format: CIF

Lattice Constants: 2.864 2.864 2.864

Lattice Angles: 60.000 60.000 60.000

Total Atoms: 1

Number of Atoms: [Al] 1

+---------------------------------------------------------------+

-->> (02) Written Al.STRU File!

o---------------------------------------------------------------o

| WARNING: Your are using a beta version of ATOMKIT |

| Please Upgrade to the latest stable version if available |

| Any Suggestions for Improvement are Welcome and Appreciated |

o---------------------------------------------------------------o



å¯ä»¥çœ‹åˆ°ATOMKITè‡ªåŠ¨è¯»å–äº†Al.cifæ–‡ä»¶ï¼Œå¹¶å°†å…¶è½¬åŒ–ä¸ºäº†ABACUSçš„STRUæ ¼å¼æ–‡ä»¶Al.STRUï¼Œè¿™ä¸€æ–‡ä»¶å†…å®¹ä¸ºï¼š

`ATOMIC_SPECIES`

Al 26.982 Al_ONCV_PBE-1.0.upf


NUMERICAL_ORBITAL

Al_gga_7au_100Ry_4s4p1d.orb


LATTICE_CONSTANT

1.889726


LATTICE_VECTORS

2.863782463806 0.000000000000 0.000000000000

1.431891231903 2.480108364568 0.000000000000

1.431891231903 0.826702788189 2.338268590218


ATOMIC_POSITIONS

Direct


Al

0.000

1

0.000000000000 0.000000000000 0.000000000000 1 1 1 mag 0.0


è¯»è€…å¯è‡ªè¡Œæ€è€ƒä¸ºä»€ä¹ˆLATTICE_VECTORSçœ‹èµ·æ¥å’Œä¹‹å‰çš„STRUæ–‡ä»¶ä¸åŒã€‚è¿™é‡Œèƒ½ç»™å‡ºçš„ç»“è®ºæ˜¯äºŒè€…ç­‰ä»·ã€‚

`from ase.io import read, write`

# read existing STRU file

structure = read("STRU", format="abacus")

# write this structure to CIF

write("my_stru.cif", stru, format='cif')



`1`

113

101 STRU



ç„¶åé€šè¿‡å¦‚ä¸‹æ–¹å¼ï¼š

`atomkit < example.txt`



é™¤å»ä¸Šè¿°ä¸¤ç§æ–¹å¼ä»¥å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªå·¥å…·abacustestä¹Ÿèƒ½ç”¨æ¥å‡†å¤‡ABACUSçš„STRUç­‰è¾“å…¥æ–‡ä»¶ã€‚

abacustestï¼ˆhttps://github.com/pxlxingliang/abacus-testï¼‰ç”¨äºå¯¹ABACUSè¿›è¡Œå‰åå¤„ç†ï¼Œä»¥åŠé«˜é€šé‡ä»»åŠ¡çš„è®¡ç®—ã€‚ç›®å‰abacustestæœ‰ä¸¤ç§å®‰è£…æ–¹å¼ï¼šé€šè¿‡pipä»PyPiæºå®‰è£…ï¼Œæˆ–è€…æ˜¯gitæ‹‰å–ä»“åº“åæºç å®‰è£…ï¼š

`# install via pip`

pip install abacustest

# install via git+pip

git clone https://github.com/pxlxingliang/abacus-test.git

cd abacus-test

pip install .



å°±å¿«é€Ÿå‡†å¤‡å•ä¸ªæˆ–å‡ ä¸ªABACUSä»»åŠ¡çš„è¾“å…¥æ–‡ä»¶è€Œè¨€ï¼Œå¯ä»¥ä½¿ç”¨abacustest model inputsåŠŸèƒ½ã€‚ä½¿ç”¨abacustest model inputs -hå¯ä»¥æŸ¥çœ‹å‡†å¤‡ABACUSè¾“å…¥æ–‡ä»¶çš„å‘½ä»¤ï¼š

`>>> abacustest model inputs -h`


------------------------------------------------------------

+ ABACUSTEST

+ version: v0.4.20

+ GITHUB: https://github.com/pxlxingliang/abacus-test/tree/develop

+ BohriumApp: https://bohrium.dp.tech/apps/abacustest

------------------------------------------------------------


usage: abacustest model inputs [-h] [-f [FILE ...]] [--ftype FTYPE] [--jtype JTYPE] [--pp PP] [--orb ORB] [--input INPUT] [--kpt [KPT ...]] {prepare,post} ...


Prepare the ABACUS inputs file.


positional arguments:

{prepare,post}

prepare Prepare the model

post Post-process the model


options:

-h, --help show this help message and exit

-f [FILE ...], --file [FILE ...]

the structure files

--ftype FTYPE the structure type, should be cif or dpdata supportted type like: poscar, abacus/stru, ..

--jtype JTYPE the job type, should be one of ['scf', 'relax', 'cell-relax', 'md', 'band']

--pp PP the path of pseudopotential library, or read from enviroment variable ABACUS_PP_PATH

--orb ORB the path of orbital library, or read from enviroment variable ABACUS_ORB_PATH

--input INPUT the template of input file, if not specified, the default input will be generated

--kpt [KPT ...] the kpoint setting, should be one or three integers



1.ç»“æ„ (-f)ï¼šæ”¯æŒCIFæ–‡ä»¶ï¼ŒPOSCARï¼Œæˆ–ç›´æ¥ä½¿ç”¨ABACUSçš„STRUã€‚

2.èµåŠ¿åº“ (-pp): ABACUS è®¡ç®—æ‰€éœ€çš„èµåŠ¿åº“è·¯å¾„ã€‚

3.è½¨é“åº“ (-orb): ABACUS è®¡ç®—æ‰€éœ€çš„è½¨é“åº“è·¯å¾„ã€‚

æ³¨ï¼šèµåŠ¿åº“å’Œè½¨é“åº“çš„æ–‡ä»¶åéœ€ä»¥å…ƒç´ åå¼€å¤´ï¼Œæˆ–è€…åœ¨å…¶ä¸­å‡†å¤‡ä¸€ä¸ªelement.jsonæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹ä¸º{å…ƒç´ åï¼šèµåŠ¿æ–‡ä»¶å}çš„dictã€‚å¦‚æ­¤ç¨‹åºæ‰èƒ½è‡ªåŠ¨æŸ¥æ‰¾å…ƒç´ å¯¹åº”çš„èµåŠ¿å’Œè½¨é“ã€‚å¦‚æœåœ¨èµåŠ¿åº“çš„ç›®å½•ä¸‹åŒæ—¶æä¾›äº†æ–‡ä»¶ecutwfc.jsonï¼ˆå…¶å†…å®¹ä¸ºæ¯ç§å…ƒç´ æ¨èçš„ecutwfcçš„å€¼ï¼Œæ ¼å¼ä¸element.jsonæ–‡ä»¶ç›¸åŒï¼‰ï¼Œabacustestä¼šè‡ªåŠ¨æ£€æŸ¥ä½“ç³»çš„å…ƒç´ ï¼Œå¹¶è‡ªåŠ¨è®¾ç½®ecutwfcä¸ºä½“ç³»æ‰€æœ‰å…ƒç´ çš„æœ€å¤§å€¼ã€‚

ä¹‹åï¼Œç”¨æˆ·å¯ä»¥ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š

`abacustest model inputs -f 1.cif 2.cif \`

--ftype cif \

--pp /path/to/your/pp_dir \

--orb /path/to/your/orb_dir



åŒæ—¶ï¼Œabacustestä¹Ÿæ”¯æŒåŸºäºå‡†å¤‡å¥½çš„è®¾ç½®ï¼Œæ‰¹é‡å‡†å¤‡è¾“å…¥ä»»åŠ¡ï¼Œç”¨æˆ·éœ€è¦å‡†å¤‡ç±»ä¼¼äºä¸‹é¢çš„param.jsonæ–‡ä»¶ï¼š

`{`

"prepare":{

"strus": ["1.vasp", "2.vasp"],

"stru_format": "poscar",

"input_template": "INPUT",

"kpt_template": "KPT",

"pp_dict": {"H": "H.upf", "O": "O.upf"},

"orb_dict": {"H": "H.orb", "O": "O.orb"},

"pp_path": "path/to/pp",

"orb_path": "path/to/orb"

}

}



`abacustest prepare -p param.json -s abacustest`



# ABACUS ä½¿ç”¨æ•™ç¨‹ï½œå¦‚ä½•è½¬æ¢ STRU æ–‡ä»¶

ç»å¸¸æœ‰åŒå­¦é—® CIF æ–‡ä»¶æ€ä¹ˆè½¬ STRU, POSCAR æ€ä¹ˆè½¬ STRUï¼Œä»¥åŠåè¿‡æ¥åˆæ€ä¹ˆåšï¼Ÿè¿™ä¸ªæ–‡æ¡£å°±æ¥å›ç­”è¿™ä¸ªé—®é¢˜ã€‚

æ€»çš„å›ç­”æ˜¯ï¼šæˆ‘ä»¬æ¨èä½¿ç”¨Python ASE-ABACUS æ¥å£æ¥åšã€‚å…·ä½“çš„æ“ä½œæ­¥éª¤å’Œä¾‹å­å¦‚ä¸‹ï¼š

## 1 å®‰è£… python ase-abacus æ¨¡å—

ï¼ˆåœ¨æœ¬ç¯‡ Notebook é•œåƒä¸­å·²å®‰è£…ï¼Œå¯è·³è¿‡ï¼‰

```
%%bash
# å®‰è£… ase-abacus
git clone https://gitlab.com/1041176461/ase-abacus.git
cd ase-abacus
python3 setup.py install
```

## 2 è®¾ç½®ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰

[ABACUS](http://abacus.ustc.edu.cn/main.htm)æ”¯æŒä¸¤ç§åŸºç»„PW, LCAOã€‚èµåŠ¿å’Œè½¨é“æ–‡ä»¶çš„å­˜æ”¾è·¯å¾„å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡è®¾ç½®ï¼Œåˆ†åˆ«ä¸ºï¼šABACUS_PP_PATH å’Œ ABACUS_ORBITAL_PATH,è®¾ç½®æ–¹æ³•å¦‚ä¸‹ï¼š

```
%%bash
# Set up the environment for ABACUS
PP=${HOME}/pseudopotentials  # èµåŠ¿æ–‡ä»¶è·¯å¾„
ORB=${HOME}/orbitals  # è½¨é“æ–‡ä»¶è·¯å¾„
export ABACUS_PP_PATH=${PP}  # è®¾ç½®ç¯å¢ƒå˜é‡
export ABACUS_ORBITAL_PATH=${ORB}  # è®¾ç½®ç¯å¢ƒå˜é‡
```


PW èµåŠ¿è®¡ç®—åªéœ€è¦è®¾ç½® ABACUS_PP_PATH ã€‚ LCAO èµåŠ¿éœ€è¦ä¸¤ä¸ªéƒ½è®¾ç½®ï¼šABACUS_PP_PATH å’Œ ABACUS_ORBITAL_PATH ã€‚

## 3 åŠ å…¥ ABACUS è®¡ç®—å™¨çš„æ–¹æ³•

åœ¨ Python è„šæœ¬ä¸­å¼•å…¥ ABACUS æ¥å£çš„æ–¹å¼ä¸ºï¼š

```python
from ase.calculators.abacus import Abacus
```

## 4 STRU æ ¼å¼è½¬åŒ–ä¾‹å­

åœ¨ç¤ºä¾‹æ•°æ®é›†ä¸­ï¼Œæˆ‘ä»¬ä¸ºä½ å‡†å¤‡å¥½äº†æ ¼å¼è½¬æ¢çš„ç¤ºä¾‹æ–‡ä»¶ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥è®¿é—®ï¼š


```python
! tree /bohr/abacus-stru-q28v/v2/
```

    [01;34m/bohr/abacus-stru-q28v/v2/[0m
    â””â”€â”€ [01;34mABACUS_STRU[0m
        â”œâ”€â”€ [01;34mCIF2STRU[0m
        â”‚Â Â  â””â”€â”€ [01;32mAMS_DATA-92.cif[0m
        â”œâ”€â”€ [01;34mPOSCAR2STRU[0m
        â”‚Â Â  â””â”€â”€ [01;32mPOSCAR[0m
        â”œâ”€â”€ [01;34mSTRU2CIF[0m
        â”‚Â Â  â””â”€â”€ [01;32mSTRU[0m
        â””â”€â”€ [01;34mSTRU2POSCAR[0m
            â””â”€â”€ [01;32mSTRU[0m
    
    5 directories, 4 files
    

å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œæˆ‘ä»¬æ²¡æœ‰æ•°æ®é›†æ‰€åœ¨æ–‡ä»¶å¤¹çš„å†™å…¥æƒé™ï¼Œå› æ­¤æˆ‘ä»¬å°†å…¶å¤åˆ¶åˆ° `/data/` ç›®å½•ä¸‹:


```python
! cp -nr /bohr/ /data/
```

### 4.1 CIF è½¬ STRU

*.cif æ˜¯å¸¸è§çš„æ™¶ä½“ç»“æ„æ–‡ä»¶ï¼Œè¿™é‡Œæä¾›äº†ä¸€ç§ cif æ–‡ä»¶è½¬ STRU æ–‡ä»¶çš„æ–¹æ³•ï¼š


```python
from ase.io import read, write
import os

parent_path = os.path.join("/", "data", "bohr", "abacus-stru-q28v", "v2", "ABACUS_STRU")

cs_dir = os.path.join(parent_path, "CIF2STRU")

# CIFæ–‡ä»¶è·¯å¾„
cs_vasp = os.path.join(cs_dir, "AMS_DATA-92.cif")

# è¯»å–CIFæ–‡ä»¶
cs_atoms = read(cs_vasp, format="cif")

# è¾“å‡ºçš„STRUæ–‡ä»¶è·¯å¾„
cs_stru = os.path.join(cs_dir, "STRU")

# èµåŠ¿æ–‡ä»¶è·¯å¾„
pp = {"Si": "Si.PD04.PBE.UPF", "O": "O.upf"}

# åŸºç»„æ–‡ä»¶è·¯å¾„
basis = {"Si": "Si_gga_10au_100Ry_3s3p2d.orb", "O": "O.orb"}  

# è¾“å‡ºSTRUæ–‡ä»¶
write(cs_stru, cs_atoms, format="abacus", pp=pp, basis=basis)  
```

å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬çš„ CIF2STRU æ–‡ä»¶å¤¹ä¸‹é™¤äº† cif æ–‡ä»¶å¤–ï¼Œç”Ÿæˆäº†ç›¸åº”çš„ STRU æ–‡ä»¶ï¼š


```python
! tree /data/bohr/abacus-stru-q28v/v2/ABACUS_STRU
```

    [34;42m/data/bohr/abacus-stru-q28v/v2/ABACUS_STRU[0m
    â”œâ”€â”€ [34;42mCIF2STRU[0m
    â”‚Â Â  â”œâ”€â”€ [01;32mAMS_DATA-92.cif[0m
    â”‚Â Â  â””â”€â”€ [01;32mSTRU[0m
    â”œâ”€â”€ [34;42mPOSCAR2STRU[0m
    â”‚Â Â  â””â”€â”€ [01;32mPOSCAR[0m
    â”œâ”€â”€ [34;42mSTRU2CIF[0m
    â”‚Â Â  â””â”€â”€ [01;32mSTRU[0m
    â””â”€â”€ [34;42mSTRU2POSCAR[0m
        â””â”€â”€ [01;32mSTRU[0m
    
    4 directories, 5 files
    

### 4.2 STRU è½¬ CIF


```python
from ase.io import read, write
import os

cs_dir = os.path.join(parent_path, "STRU2CIF")
cs_stru = os.path.join(cs_dir, 'STRU')
cs_atoms= read( cs_stru, format='abacus')
cs_vasp = os.path.join(cs_dir, 'STRU.cif')
write(cs_vasp, cs_atoms, format='cif')
```

### 4.3 POSCAR è½¬ STRU

POSCAR æ˜¯å¸¸è§ç¬¬ä¸€æ€§åŸç†è®¡ç®—è½¯ä»¶ VASP çš„ç»“æ„æ–‡ä»¶ï¼Œè¿™é‡Œæä¾›äº†ä¸€ç§ POSCAR è½¬ STRU æ–‡ä»¶çš„æ–¹æ³•ï¼š


```python
from ase.io import read, write
import os

cs_dir = os.path.join(parent_path, "POSCAR2STRU")
cs_vasp = os.path.join(cs_dir, "POSCAR")
cs_atoms = read(cs_vasp, format="vasp")
cs_stru = os.path.join(cs_dir, "STRU")

# # éœ€è¦è®¾ç½®åŸå­ç£çŸ©æ—¶ï¼Œå¯æ·»åŠ ä»£ç ï¼š
# cs_atoms.set_initial_magnetic_moments([1.0,1.0,1.0,2.0])  # åé¢åˆ—è¡¨é‡Œåˆ—å‡ºæ¯ä¸ªåŸå­çš„ç£çŸ©ï¼›

# # å¦‚æœéœ€è¦è®¾ç½®æ¯ä¸ªåŸå­æ¯ä¸ªæ–¹å‘çš„ç£çŸ©ï¼Œåˆ™éœ€è¦è®¾ç½®ä¸ºäºŒç»´æ•°ç»„ï¼š
# cs_atoms.set_initial_magnetic_moments([[1.0,1.0,1.0],
#                                        [1.0,1.0,2.0],
#                                        [1.0,1.0,3.0],
#                                        [1.0,1.0,4.0]])

pp = {"Al": "Al.PD04.PBE.UPF"}
basis = {"Al": "Al_gga_10au_100Ry_3s3p2d.orb"}
write(cs_stru, cs_atoms, format="abacus", pp=pp, basis=basis)

```

### 4.4 STRU è½¬ POSCAR


```python
from ase.io import read, write
from pathlib import Path
from ase.calculators.abacus import Abacus

cs_dir = os.path.join(parent_path, "STRU2POSCAR")
cs_stru = os.path.join(cs_dir, 'STRU')
cs_atoms= read(cs_stru, format='abacus')
cs_vasp = os.path.join(cs_dir, 'POSCAR')
write(cs_vasp, cs_atoms, format='vasp')
```
