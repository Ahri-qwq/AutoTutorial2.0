<!-- META_START -->
# ABACUS 实战指南：LCAO 基组精度评估与基准测试

## 前言
- **本书逻辑**: 本教程遵循“理论认知 -> 建立基准 -> 变量测试 -> 结果分析”的科学实验范式。首先阐明 LCAO 与 PW 的物理本质差异，随后建立高精度的 PW 计算作为“真值”基准，进而系统性地测试不同精度 LCAO 基组（SZ/DZP/TZDP）的表现，最后通过数据分析揭示精度与效率的平衡点。
- **核心知识点**: LCAO 与 PW 基组原理、数值原子轨道（NAO）文件解读、变分原理在基组测试中的应用、输入参数的精确控制、能量-体积（E-V）曲线分析。

<!-- CHAPTER_START -->
## 第一章：物理基础与测试策略
**本章逻辑**: 在动手计算前，必须先理解“为什么要做对比测试”以及“我们在测试什么”。本章将从物理原理出发，解释 LCAO 的优势与劣势，并教会读者如何阅读核心文件——轨道文件。

### Section 1.1: 平面波 (PW) vs. 局域轨道 (LCAO)
- **内容**: 简述两种基组的数学表达形式。解释为何 PW 精度高但计算昂贵（基组完备性），而 LCAO 效率高但依赖基组选取。引入“变分原理”，说明为何 PW 的能量通常低于 LCAO。
- **关键参数**: `basis_type` (pw / lcao)

### Section 1.2: 解读数值原子轨道 (.orb) 文件
- **内容**: 详解轨道文件名的命名规则（如 `Si_gga_7au_100Ry_2s2p1d.orb`），通过文件名判断基组精度（SZ/DZP/TZDP）、截断半径和推荐截断能。
- **关键参数**: 无（重点在于理解文件名中的 `7au`, `100Ry`, `2s2p1d` 等字段含义）

### Section 1.3: 测试方案设计：控制变量法
- **内容**: 制定实验协议。强调在对比过程中，除了 `basis_type` 和 `.orb` 文件外，必须严格保持 `pseudo_dir`（赝势）、K点网格、晶体结构完全一致。
- **关键参数**: `pseudo_dir`, `orbital_dir`

<!-- CHAPTER_START -->
## 第二章：建立基准——平面波 (PW) 计算
**本章逻辑**: 没有基准的测试是毫无意义的。本章指导读者运行高精度的 PW 计算，获取体系的“参考真值”（Ground Truth），为后续评估 LCAO 误差提供标尺。

### Section 2.1: PW 模式下的输入文件配置
- **内容**: 设置 `INPUT` 文件以启动 PW 计算。重点讲解 `ecutwfc` 在 PW 模式下对精度的决定性作用，以及如何确认收敛性。
- **关键参数**: `basis_type = pw`, `ecutwfc` (建议值如 100 Ry)

### Section 2.2: 运行计算与数据记录
- **内容**: 执行计算并提取总能量（Total Energy）。解释为何此时不需要 `orbital_dir`，但必须确保赝势文件正确。
- **关键参数**: `calculation = scf`

<!-- CHAPTER_START -->
## 第三章：LCAO 基组阶梯测试 (SZ -> DZP -> TZDP)
**本章逻辑**: 这是核心实验章节。按照精度由低到高的顺序，逐步替换轨道文件，观察计算结果的变化。同时解决 LCAO 模式下特有的参数设置问题。

### Section 3.1: 最小基组 (SZ) 的快速预估
- **内容**: 配置 SZ 级别的轨道文件。演示如何在 `STRU` 文件的 `ATOMIC_SPECIES` 中正确关联 `.orb` 文件。运行计算并指出结果的粗糙性（强调仅作教学或极粗略估算）。
- **关键参数**: `basis_type = lcao`, `orbital_dir`

### Section 3.2: 标准基组 (DZP) 与高精度基组 (TZDP) 的进阶
- **内容**: 将轨道文件替换为 DZP 和 TZDP 版本。详细说明如何在 `INPUT` 中保持 `ecutwfc` 不变（解释 LCAO 中 `ecutwfc` 仅影响积分网格而非基组完备性的误区）。
- **关键参数**: `ecutwfc` (保持与 PW 一致或遵循轨道文件推荐), `ks_solver` (如遇 ELPA 报错，切换为 `scalapack_gvx`)

### Section 3.3: 混合基组策略（进阶）
- **内容**: 针对多元素体系，讲解如何在 `STRU` 中为不同元素指定不同精度的轨道文件（例如：关键原子用 TZDP，环境原子用 DZP），以平衡效率与精度。
- **关键参数**: 待定(需查阅文档确认 `STRU` 中多轨道具体写法)

<!-- CHAPTER_START -->
## 第四章：结果分析与精度评估
**本章逻辑**: 获得数据后，需要科学的方法进行分析。单纯比较单点能是不够的，本章引入 E-V 曲线和相对误差分析，帮助读者做出最终的基组选择。

### Section 4.1: 绝对能量与相对趋势分析
- **内容**: 汇总 PW、SZ、DZP、TZDP 的总能量。绘制对比图表。解释为何 $E_{LCAO} > E_{PW}$ 是正常的，并计算每原子能量差（eV/atom）。
- **关键参数**: 无（数据处理环节）

### Section 4.2: 能量-体积 (E-V) 曲线扫描
- **内容**: 改变晶格常数，计算一系列体积下的能量。对比不同基组下的平衡晶格常数 ($a_0$) 和体模量 ($B_0$)。说明这比单一能量对比更具物理意义。
- **关键参数**: `calculation = scf` (需配合脚本或手动修改 `STRU` 进行多点计算)

### Section 4.3: 效率评估：时间与内存
- **内容**: 对比不同基组下的 CPU 时间和内存消耗。分析“精度收益”与“计算成本”的性价比，指导实际科研中的选择。
- **关键参数**: 无（查看输出日志中的 `Time` 和 `Memory` 信息）

<!-- APPENDIX_START -->
## 附录：常见问题与避坑指南
- **BSSE 误差**: 提醒在小分子体系计算中 LCAO 可能面临的基组重叠误差。
- **求解器崩溃处理**: 针对 `ks_solver` 默认 ELPA 可能导致的并行错误，提供 ScaLAPACK 替代方案。
- **内存爆炸**: 警告长截断半径（>10 au）或 TZDP 基组在大体系下的内存风险。
- **不可用的 SZ**: 再次强调 SZ 结果不可用于发表文章。